{"componentChunkName":"component---src-templates-blog-post-js","path":"/data-structure/hashtable/","result":{"data":{"site":{"siteMetadata":{"title":"renuevo blog","author":"rubber","siteUrl":"https://renuevo.github.io","comment":{"disqusShortName":"https-renuevo-github-io","utterances":""},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"be0ad56e-0c26-5e61-b099-c519f6bab6ab","excerpt":"Map 인터페이스에 대한 내부구조 알아보기 약간의 사연이 있어서 😢 편리하게 사용하고 있는 Map관련 내부구조를 다시 보고 정리하면서 확인해 보려고 합니다 간단히 비교해 보기  HashMap HashTable ConcurrentHashMap null able ✔️ ❌ ❌ thread-safe ❌ ✔️ ✔️ 사용 환경 single-thread ConcurrentHashMap을 사용 multi-thread HashMap (해시맵) Hash 알고리즘 먼저 key를 저장하는 hash…","html":"<p><strong><em>Map 인터페이스에 대한 내부구조 알아보기</em></strong><br>\n약간의 사연이 있어서 😢<br>\n편리하게 사용하고 있는 Map관련 내부구조를 다시 보고 정리하면서 확인해 보려고 합니다</p>\n<h2 id=\"간단히-비교해-보기\" style=\"position:relative;\"><a href=\"#%EA%B0%84%EB%8B%A8%ED%9E%88-%EB%B9%84%EA%B5%90%ED%95%B4-%EB%B3%B4%EA%B8%B0\" aria-label=\"간단히 비교해 보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>간단히 비교해 보기</h2>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>HashMap</th>\n<th>HashTable</th>\n<th>ConcurrentHashMap</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>null able</strong></td>\n<td>✔️</td>\n<td>❌</td>\n<td>❌</td>\n</tr>\n<tr>\n<td><strong>thread-safe</strong></td>\n<td>❌</td>\n<td>✔️</td>\n<td>✔️</td>\n</tr>\n<tr>\n<td><strong>사용 환경</strong></td>\n<td>single-thread</td>\n<td>ConcurrentHashMap을 사용</td>\n<td>multi-thread</td>\n</tr>\n</tbody>\n</table>\n<br/>\n<h2 id=\"hashmap-해시맵\" style=\"position:relative;\"><a href=\"#hashmap-%ED%95%B4%EC%8B%9C%EB%A7%B5\" aria-label=\"hashmap 해시맵 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HashMap (해시맵)</h2>\n<h3 id=\"hash-알고리즘\" style=\"position:relative;\"><a href=\"#hash-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98\" aria-label=\"hash 알고리즘 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hash 알고리즘</h3>\n<p>먼저 key를 저장하는 hash와 관련된 내용부터 살펴 보겠습니다</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">//String.java의 JDK11 기준 -> jdk8부터는 큰 차이가 없습니다  </span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> h <span class=\"token operator\">=</span> hash<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> value<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        hash <span class=\"token operator\">=</span> h <span class=\"token operator\">=</span> <span class=\"token function\">isLatin1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token class-name\">StringLatin1</span><span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span>\n                              <span class=\"token operator\">:</span> <span class=\"token class-name\">StringUTF16</span><span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> h<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//Lation1</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">int</span> <span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> h <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span> v <span class=\"token operator\">:</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        h <span class=\"token operator\">=</span> <span class=\"token number\">31</span> <span class=\"token operator\">*</span> h <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>v <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> h<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//UTF16</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">int</span> <span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> h <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> length <span class=\"token operator\">=</span> value<span class=\"token punctuation\">.</span>length <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        h <span class=\"token operator\">=</span> <span class=\"token number\">31</span> <span class=\"token operator\">*</span> h <span class=\"token operator\">+</span> <span class=\"token function\">getChar</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> h<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">//해시 보조</span>\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token function\">hash</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> key<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> h<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">>>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>기본적으로 key의 hashCode() 값을 기반으로 보조 해시함수로 비트연산자를 활용하여 계산합니다</p>\n<br/>\n<p>hashCode()의 경우 char를 돌면서 31을 곱하면서 계산합니다<br>\n짝수를 곱할 경우 내부연산에서 곱을 왼쪽으로 이동하는 쉬프트 연산으로 계산하면서<br>\noverflow가 되고 0만 가득차게 될 수 있기 때문에 홀수와 소수인 31을 관행적으로 사용한다고 합니다</p>\n<br/>\n<p>보조해시 함수를 <code class=\"language-text\">test</code>를 예를 들어 설명하겠습니다</p>\n<blockquote>\n<ol>\n<li>test의 hashCode()는 3556498이고 bit값은 <code class=\"language-text\">1101100100010010010010</code>입니다</li>\n<li>bit연산으로 (h >>> 16)으로 앞의 6자리만을 남깁니다 <code class=\"language-text\">110110</code></li>\n<li>1번과 2번의 값을 xor 연산하여 3556516을 도출합니다 <code class=\"language-text\">1101100100010010100100</code></li>\n</ol>\n</blockquote>\n<p>보는 것과 같이 hash 함수가 엄청 간단합니다</p>\n<br/>\n<p>이렇게 간단하게 구현된 해시값이 겹치지 않을까요!? 👉 <strong>물론 겹칠 수 있습니다</strong><br>\n이전에는 보다 복잡한 보조해시를 썼지만 hashCode() 자체의 알고리즘 개선과 효율성 측면에서 간단하게 계산합니다<br>\n법그래서 별도의 <strong>Separate Chaining(분리 연결법), Open Addressing(개방 주소)</strong>\n으로 <a href=\"https://renuevo.github.io/data-structure/hashtable/#hash-collision%ED%95%B4%EC%8B%9C-%EC%B6%A9%EB%8F%8C\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">해시 충돌</a>을 예방합니다</p>\n<br/>\n<br/>\n<h3 id=\"hashmap의-내부-구조\" style=\"position:relative;\"><a href=\"#hashmap%EC%9D%98-%EB%82%B4%EB%B6%80-%EA%B5%AC%EC%A1%B0\" aria-label=\"hashmap의 내부 구조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HashMap의 내부 구조</h3>\n<p>저장되는 데이터 구조를 살펴보겠습니다</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">transient</span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> table<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">float</span> DEFAULT_LOAD_FACTOR <span class=\"token operator\">=</span> <span class=\"token number\">0.75f</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> TREEIFY_THRESHOLD <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Map<span class=\"token punctuation\">.</span>Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> hash<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">K</span> key<span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">V</span> value<span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> next<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//Red-Black Tree</span>\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TreeNode</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">LinkedHashMap<span class=\"token punctuation\">.</span>Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">TreeNode</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> parent<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// red-black tree links</span>\n    <span class=\"token class-name\">TreeNode</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> left<span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">TreeNode</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> right<span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">TreeNode</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> prev<span class=\"token punctuation\">;</span>    <span class=\"token comment\">// needed to unlink next upon deletion</span>\n    <span class=\"token keyword\">boolean</span> red<span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">TreeNode</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> hash<span class=\"token punctuation\">,</span> <span class=\"token class-name\">K</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">V</span> val<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> next<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">,</span> next<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>저장 데이터 단위는 Node로 구성되어 있습니다<br>\nHashMap은 처음 생성될시에 기본적으로 16개의 Node를 저장할 수 있는 배열저장소를 내부에 생성합니다<br>\n이걸 <code class=\"language-text\">Buckets</code>이라고 부릅니다</p>\n<br/>  \n<p><strong>HashMap의 내부 운영 방식</strong></p>\n<ol>\n<li><strong>Buckets 사이즈 조절</strong><br>\n이전에 알아본 hash값을 기반으로 <code class=\"language-text\">(table.length - 1) &amp; hash</code> buckets내의 자리를 찾고 그곳에 Node를 저장하게 됩니다<br>\n이후 16개의 DEFAULT_LOAD_FACTOR(75%)비율이 차게되면 buckets값을 2배 늘리고 값을 재분배하는 과정을 거칩니다</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.83236994219652%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD90lEQVQ4y32SC0xbVRjHvz4GzJg4p5G4ucXFMSePYWwWHIIyHBkxYozGjETNYrLpdBGHWVYYxsHWOh5jKziEDkwty8rK2Ag4IiCvDkcLLSt9XPq4t7dvoPS1YhnPcDxX8RGz7CS/fDnfueef//3+B+DfxVrnv/tHLdZDeOTHsCEu5gUOl5PL2cDN4OW+zmF6+YfzWeXflz/0cmZ25j/9jZhkzMuYJ9d7z6/vMzEZmF0cFot7vUsKFXXnmPMtTG+dFMy2vWl716+mpGyEuLhUiIlJZ23e/MwO3HpiS/z2V995Myf743ez3sh/OyctLzsL2BBLB7yxKtPEY6/tz9iXyks9xEvj5e15Zc/76VnpB0USETaGEIDBAMDnAxQUAFy+AnkoDF4Ufbr9gd58K6oLtc/rf+9YMI58mHMQJhzjl7qGO0nCQxDOiHOODtEB55xzlgpQKx19HZ8wgk/B4mIChEI7IRhMiPX7EmAJbT8dJXe3hTSB1pAGtYbHUbNrmMLGd0ivmRslzSaqiZR6G6z1SGwRI9GYCImtYnRh7MJRRrACHA4EdvsSrqssgliBQBDtjgYK5WQPJXEq0BVzD2qy9pmAC9tEF93iivMW6ju62lms46My29nVU+pTy6VkKSrRlxwBWFuLh7m5ZFhZeQkWFhJjlpeSYA3t+ipAJMn9ozM/Uv2o0dKLfnIozEwA4kZL7Q/1hLbWVO+q0lWiGmvtWuW9ytVqYzUSKAVHGIfZEA6XgcdTDF7vabadLoHog5LcJf+Ba3S/W+oeRm0RLboRHjcdey8fz1Df8MvdntkJ58SUJWBBJp8JmQPmP2vnUOenjGARTE/PAkGQ+LdtLKORgvsRT1LI+1mro98ux/OTB9UMRNW9W7FiScMm2e3rzwpFwp2Ci+eSTn57MrWorChFcEmQfKLkxKa/Uv7fqkjbCt0L+q1tc1pfa5gJRYMdaiafw2dau+qtrt/aC9WE+msDZRCojWqh1qI9qyN15Tdv3+QBnt032FkEO3QBSXpYNO0Gl9ufFJn5vMXaTTdPjSCZT4Vk00pmhmyV0dLU2T88+6u1b17hUqAhHNqAbQANOgbR1cGrXzKC+8HlOgM0zQens4jtdheD21ucMz99oM034mBmKLEPIgk9SGDBxLrL3sYakd1aZa8hSyfPrApJ4Tz/Lj8qpISo1FiK3+HyMmAxAJMJgMJPzeaAF90k2PwD8Xh+izgMdOP+OBOKp/u8FLS2ybqfh3o9CvOdiNKuRCP0CPq7ynplxxmHbJia4uKUuUyNn8HVhdj1Yd3jrUH1RziMo/LA2DHMB8hiALPPsE+h6z90R6M4PGocLVDpVccxXyj1ysKW9pbEPwC0CU6hoqIzpgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"hash buckets\"\n        title=\"hash buckets\"\n        src=\"/static/ea030c85da279b0df066a730b73f0e6e/1e043/hash-bucket.png\"\n        srcset=\"/static/ea030c85da279b0df066a730b73f0e6e/991de/hash-bucket.png 173w,\n/static/ea030c85da279b0df066a730b73f0e6e/e4d6b/hash-bucket.png 345w,\n/static/ea030c85da279b0df066a730b73f0e6e/1e043/hash-bucket.png 690w,\n/static/ea030c85da279b0df066a730b73f0e6e/e3189/hash-bucket.png 1035w,\n/static/ea030c85da279b0df066a730b73f0e6e/21b4d/hash-bucket.png 1280w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Source : <a href=\"https://en.wikipedia.org/wiki/Hash_table\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hash Table Wiki</a> </span></p>\n<br/>  \n<ol start=\"2\">\n<li><strong>Linked List</strong><br>\nNode를 보시면 <code class=\"language-text\">Node&lt;K,V> next</code>를 보실 수 있습니다<br>\nkey의 hash가 같은 Buckets 인덱스에 할당되면 key를 확인하고 다른 값이면 Linked List로 다음 Node로 해당 값을 저장합니다<br>\n이런 방식을 Separate Chaining(분리 연결법)이라고 합니다 👉 밑에서 자세히 살펴 보겠습니다</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.78612716763006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADsElEQVQ4y3WTbUybVRTHT0GgUCgTnVETZyTzE8z5QeMIicbNZC4ajGXZsmxMkmVbZhbXhqVloe8tlL4TDCOZToPLOl9Ii91oh6V1MATC21poV1YrgwqTAgMCsi1m7vF/u5qoiU9ycu+597m/+z/n3EP0ny83L5c4jkvZ/B/zPDb+/VWaKqllrYVOfHfiX2cOnj1IzavNpBxTpleKirKpoIBPTidRGtYT+5Y2uElKA7NgT7DJPy7IyuJnCTYXb06t83H88V55OfOFsC12ttB2gSyGUzzzOSkluaFia6vywyMfHdlfUJgvqFBWpA5VtVaxM5tgL8Hydp/eTbV9tRTgAnBDoQz8xctmOxyXmVaYCtUTiF7y9AeXHMGLndh+7kz/mTbLnGVAf0sfUIVUfsx9poQpoAlrAtqIdtAwZWgmevRIRouLIzQ93YVxqODBg8p0UE+2u+L+9u5xznbNEswm/iaxV/xy3WDddkmXpPT418e31XTXvCK7Ltt28vuTpbDt0l5pMQOW0MLCHpqc3EVLS+9uGRvbWkf09KenDlAk0bNnIOz75LLvymFckAngx4a4wai7qdOqQ2o95vr6WL1eF9VpodqI8SjRw4diWl0NUCLRTisrfrp/vwIKszmfg4Z/n/ugPxGWdnS5qgF8/lDroTrjtFGtvKGUI3xF/a16RUO8QQG4XDOh0QFYzcq2A8BqAPfTxkY1/K0A8pIIeaq2pnu0ScVZrjcFc5Divaa9u/A03pSPyN+QD8vLoLQMoDLFqGKHYkRRjnkJA1bR8vKXFI02Qd0XUPkOgHl8KHJKLnd8Y3OuSX6S/AiFGUi+GQp9AHQA6Db8YnA33m50Q2EH7AekoJGF/D6trWkBktK9e5qiubkyGdGzrMq9sdnP/Tej05euOdyC3PxnRMZKocQrKbQv2IXnufNCgIUojtCWtAnNs+bCY45jAlaU92hmRgWFpymZVOWvr7/+FMK14oWt/Ol5YSjkeNXjvlrC3p2sV+a1L9rjeCITCD1i/tUcMc4YI9qwdkIf1U9B7QUW8gG6e7eV4nEjcngW87dfI8phndB3I3rOPzp8+yt/W2dseZbHws7gZQhYh/6P5TDgTuRQDOBRhC6GX0qP20vgcCSuXuwMc6YBQz/8F6U90hbbvM2jn9Q7kTOX9Y7VBVUuVNcJld6GnxsaUr0LIAFIAKZ89fpvmabPrBS5My4djg26vH1eK2tXxZhip2nGtA9dIkKlRSiQCO9PpAqqROpx9T6A3/oLtDcDOlKGcSgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"hashmap buckets\"\n        title=\"hashmap buckets\"\n        src=\"/static/130e3347a853a23f466502dd9bd941a5/1e043/hashmap-bucket.png\"\n        srcset=\"/static/130e3347a853a23f466502dd9bd941a5/991de/hashmap-bucket.png 173w,\n/static/130e3347a853a23f466502dd9bd941a5/e4d6b/hashmap-bucket.png 345w,\n/static/130e3347a853a23f466502dd9bd941a5/1e043/hashmap-bucket.png 690w,\n/static/130e3347a853a23f466502dd9bd941a5/e3189/hashmap-bucket.png 1035w,\n/static/130e3347a853a23f466502dd9bd941a5/21b4d/hashmap-bucket.png 1280w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Source : <a href=\"https://en.wikipedia.org/wiki/Hash_table\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hash Table Wiki</a> </span></p>\n<br/>\n<ol start=\"3\">\n<li><strong>Red-Black Tree</strong><br>\nLinked List로 값을 저장하면 탐색 시간이 늘어나기 때문에 값이 늘어나면 효율적이지 않습니다<br>\n그래서 TREEIFY_THRESHOLD(8)로 연결이 늘어나게 되면 Node를 <code class=\"language-text\">treeifyBin()</code>를 통해 TreeNode로 변경합니다<br>\n그리고 효율적인 레드블랙트리 알고리즘으로 저장합니다</li>\n</ol>\n<p>👉 <a href=\"https://ko.wikipedia.org/wiki/%EB%A0%88%EB%93%9C-%EB%B8%94%EB%9E%99_%ED%8A%B8%EB%A6%AC\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Red-Black Tree (레드블랙 트리) Wiki</a></p>\n<br/>\n<p><strong>다음으로 put의 코드를 살펴보겠습니다</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">final</span> <span class=\"token class-name\">V</span> <span class=\"token function\">putVal</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> hash<span class=\"token punctuation\">,</span> <span class=\"token class-name\">K</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">V</span> value<span class=\"token punctuation\">,</span> <span class=\"token keyword\">boolean</span> onlyIfAbsent<span class=\"token punctuation\">,</span>\n                   <span class=\"token keyword\">boolean</span> evict<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> tab<span class=\"token punctuation\">;</span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> p<span class=\"token punctuation\">;</span> <span class=\"token keyword\">int</span> n<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>   <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>tab <span class=\"token operator\">=</span> table<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>  </span>            n <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>tab <span class=\"token operator\">=</span> <span class=\"token function\">resize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>   <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>p <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">[</span>i <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> hash<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>  </span>            tab<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">newNode</span><span class=\"token punctuation\">(</span>hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>   <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>  </span>            <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> e<span class=\"token punctuation\">;</span> <span class=\"token class-name\">K</span> k<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>       <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>hash <span class=\"token operator\">==</span> hash <span class=\"token operator\">&amp;&amp;</span></span><span class=\"gatsby-highlight-code-line\">                <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>k <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> key <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">                e <span class=\"token operator\">=</span> p<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>       <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>p <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">TreeNode</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">                e <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TreeNode</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">putTreeVal</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> tab<span class=\"token punctuation\">,</span> hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                </span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>       <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> binCount <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>binCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>e <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>next<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        p<span class=\"token punctuation\">.</span>next <span class=\"token operator\">=</span> <span class=\"token function\">newNode</span><span class=\"token punctuation\">(</span>hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span>                   <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>binCount <span class=\"token operator\">>=</span> TREEIFY_THRESHOLD <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// -1 for 1st</span></span><span class=\"gatsby-highlight-code-line\">                            <span class=\"token function\">treeifyBin</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> hash<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>hash <span class=\"token operator\">==</span> hash <span class=\"token operator\">&amp;&amp;</span>\n                        <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>k <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> key <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                    p <span class=\"token operator\">=</span> e<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// existing mapping for key</span>\n                <span class=\"token class-name\">V</span> oldValue <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>onlyIfAbsent <span class=\"token operator\">||</span> oldValue <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n                    e<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">afterNodeAccess</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> oldValue<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">++</span>modCount<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"> <span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">++</span>size <span class=\"token operator\">></span> threshold<span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token function\">resize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>        <span class=\"token function\">afterNodeInsertion</span><span class=\"token punctuation\">(</span>evict<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p>생각보다 put의 소스 자체가 복잡해 보입니다<br>\n여기서 주요 핵심부분을 8개로 나눠서 분류하고 하나씩 뜯어보겠습니다</p>\n<br/>\n<p><span class='red_font'>(1)</span> <code class=\"language-text\">if ((tab = table) == null || (n = tab.length) == 0)</code></p>\n<blockquote>\n<p>처음 등장하는 조건문입니다<br>\nbuckets이 null 이거나 사이즈가 0인지를 체크하여 resize()를 통해 저장소를 생성합니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(2)</span> <code class=\"language-text\">if ((p = tab[i = (n - 1) &amp; hash]) == null)</code></p>\n<blockquote>\n<p>hash의 buckets내의 index를 계산하고 null일 경우 Node를 바로 저장하는 조건문입니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(3)</span> <code class=\"language-text\">else</code></p>\n<blockquote>\n<p>hash의 buckets내의 index를 계산하고 null이 아닌 Node가 이미 들어 있는 경우입니다<br>\n<span class='red_font'>(4), (5), (6)</span>을 통해 put을 진행합니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(4)</span> <code class=\"language-text\">if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))</code></p>\n<blockquote>\n<p>hash와 key의 값을 비교하여 같은 key의 value 변경인지를 확인합니다<br>\n같은 key로 확인되면 단순히 Node의 value값을 변경합니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(5)</span> <code class=\"language-text\">else if (p instanceof TreeNode)</code></p>\n<blockquote>\n<p>TreeNode 여부를 확인하여 Tree구조로 put을 진행합니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(6)</span> <code class=\"language-text\">else { for (int binCount = 0; ; ++binCount)</code></p>\n<blockquote>\n<p>Node의 Linked List를 탐색하며 put을 진행합니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(7)</span> <code class=\"language-text\">if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st</code></p>\n<blockquote>\n<p><span class='red_font'>(6)</span>의 탐색을 진행하며 binCount가 너무 늘어나 탐색이 느려지는 기준점 TREEIFY_THRESHOLD(8)에<br>\n도달하게 된다면 <code class=\"language-text\">treeifyBin(tab, hash);</code>를 통해서 Node를 TreeNode로 변경합니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(8)</span> <code class=\"language-text\">if (++size > threshold)</code></p>\n<blockquote>\n<p>마지막으로 buckets의 Node사이즈를 확인하여 resize() 여부를 결정합니다</p>\n</blockquote>\n<br/>\n<p>이것으로 HashMap의 구조를 알아 봤습니다<br>\n단순히 저장해서 가져다가 쓰기만 했었는데 생각보다 내부에서는 다양한 알고리즘이 반영된걸 알 수 있었습니다</p>\n<br/>\n<p>다음은 HashMap 이전에 존재했던 HashTable에 대해 알아보겠습니다</p>\n<hr>\n<br/>\n<h2 id=\"hashtable-해시테이블\" style=\"position:relative;\"><a href=\"#hashtable-%ED%95%B4%EC%8B%9C%ED%85%8C%EC%9D%B4%EB%B8%94\" aria-label=\"hashtable 해시테이블 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HashTable (해시테이블)</h2>\n<p>다음으로 알아볼 것은 HashMap 이전에 사용된 HashTable 입니다<br>\n그래서 기능적으로 많이 닮아 있으므로 다른 부분만을 빠르게 살펴 보겠습니다</p>\n<p><strong>hash 알고리즘</strong><br>\nhash 알고리즘은 기존 HashMap과 달리 보조 해시 없이 기본 hashCode()를 그대로 사용합니다</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">int</span> hash <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<h3 id=\"hashtable의-내부-구조\" style=\"position:relative;\"><a href=\"#hashtable%EC%9D%98-%EB%82%B4%EB%B6%80-%EA%B5%AC%EC%A1%B0\" aria-label=\"hashtable의 내부 구조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HashTable의 내부 구조</h3>\n<p>저장되는 데이터 구조를 살펴보겠습니다</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">transient</span> <span class=\"token class-name\">Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> table<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">Hashtable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.75f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Map<span class=\"token punctuation\">.</span>Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n     <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> hash<span class=\"token punctuation\">;</span>\n     <span class=\"token keyword\">final</span> <span class=\"token class-name\">K</span> key<span class=\"token punctuation\">;</span>\n     <span class=\"token class-name\">V</span> value<span class=\"token punctuation\">;</span>\n     <span class=\"token class-name\">Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> next<span class=\"token punctuation\">;</span>\n     \n     <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>저장 데이터 단위는 Entry로 구성되어 있습니다<br>\nHashTable은 11개 사이즈의 <code class=\"language-text\">Buckets</code>을 생성합니다</p>\n<br/>  \n<p><strong>HashTable의 내부 운영 방식</strong></p>\n<ol>\n<li><strong>Buckets 사이즈 조절</strong>\nHashMap과 동일하게 전체의 75%가 차게되면 사이즈를 조정합니다<br>\n<code class=\"language-text\">int newCapacity = (oldCapacity &lt;&lt; 1) + 1;</code> 쉬프트 연산을 통해 기존 사이즈의 두배 +1 의 값으로 재설정 됩니다</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.83236994219652%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD90lEQVQ4y32SC0xbVRjHvz4GzJg4p5G4ucXFMSePYWwWHIIyHBkxYozGjETNYrLpdBGHWVYYxsHWOh5jKziEDkwty8rK2Ag4IiCvDkcLLSt9XPq4t7dvoPS1YhnPcDxX8RGz7CS/fDnfueef//3+B+DfxVrnv/tHLdZDeOTHsCEu5gUOl5PL2cDN4OW+zmF6+YfzWeXflz/0cmZ25j/9jZhkzMuYJ9d7z6/vMzEZmF0cFot7vUsKFXXnmPMtTG+dFMy2vWl716+mpGyEuLhUiIlJZ23e/MwO3HpiS/z2V995Myf743ez3sh/OyctLzsL2BBLB7yxKtPEY6/tz9iXyks9xEvj5e15Zc/76VnpB0USETaGEIDBAMDnAxQUAFy+AnkoDF4Ufbr9gd58K6oLtc/rf+9YMI58mHMQJhzjl7qGO0nCQxDOiHOODtEB55xzlgpQKx19HZ8wgk/B4mIChEI7IRhMiPX7EmAJbT8dJXe3hTSB1pAGtYbHUbNrmMLGd0ivmRslzSaqiZR6G6z1SGwRI9GYCImtYnRh7MJRRrACHA4EdvsSrqssgliBQBDtjgYK5WQPJXEq0BVzD2qy9pmAC9tEF93iivMW6ju62lms46My29nVU+pTy6VkKSrRlxwBWFuLh7m5ZFhZeQkWFhJjlpeSYA3t+ipAJMn9ozM/Uv2o0dKLfnIozEwA4kZL7Q/1hLbWVO+q0lWiGmvtWuW9ytVqYzUSKAVHGIfZEA6XgcdTDF7vabadLoHog5LcJf+Ba3S/W+oeRm0RLboRHjcdey8fz1Df8MvdntkJ58SUJWBBJp8JmQPmP2vnUOenjGARTE/PAkGQ+LdtLKORgvsRT1LI+1mro98ux/OTB9UMRNW9W7FiScMm2e3rzwpFwp2Ci+eSTn57MrWorChFcEmQfKLkxKa/Uv7fqkjbCt0L+q1tc1pfa5gJRYMdaiafw2dau+qtrt/aC9WE+msDZRCojWqh1qI9qyN15Tdv3+QBnt032FkEO3QBSXpYNO0Gl9ufFJn5vMXaTTdPjSCZT4Vk00pmhmyV0dLU2T88+6u1b17hUqAhHNqAbQANOgbR1cGrXzKC+8HlOgM0zQens4jtdheD21ucMz99oM034mBmKLEPIgk9SGDBxLrL3sYakd1aZa8hSyfPrApJ4Tz/Lj8qpISo1FiK3+HyMmAxAJMJgMJPzeaAF90k2PwD8Xh+izgMdOP+OBOKp/u8FLS2ybqfh3o9CvOdiNKuRCP0CPq7ynplxxmHbJia4uKUuUyNn8HVhdj1Yd3jrUH1RziMo/LA2DHMB8hiALPPsE+h6z90R6M4PGocLVDpVccxXyj1ysKW9pbEPwC0CU6hoqIzpgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"hash buckets\"\n        title=\"hash buckets\"\n        src=\"/static/ea030c85da279b0df066a730b73f0e6e/1e043/hash-bucket.png\"\n        srcset=\"/static/ea030c85da279b0df066a730b73f0e6e/991de/hash-bucket.png 173w,\n/static/ea030c85da279b0df066a730b73f0e6e/e4d6b/hash-bucket.png 345w,\n/static/ea030c85da279b0df066a730b73f0e6e/1e043/hash-bucket.png 690w,\n/static/ea030c85da279b0df066a730b73f0e6e/e3189/hash-bucket.png 1035w,\n/static/ea030c85da279b0df066a730b73f0e6e/21b4d/hash-bucket.png 1280w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Source : <a href=\"https://en.wikipedia.org/wiki/Hash_table\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hash Table Wiki</a> </span></p>\n<br/>  \n<ol start=\"2\">\n<li><strong>Linked List</strong><br>\nEntry도 Node와 같이 Linked List구조로 <code class=\"language-text\">Entry&lt;K,V> next</code>를 가지고 있는걸 보실 수 있습니다<br>\nHashMap과 동일하게 충돌방지로 Separate Chaining(분리 연결법)을 사용하는걸 알 수 있습니다</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.78612716763006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADsElEQVQ4y3WTbUybVRTHT0GgUCgTnVETZyTzE8z5QeMIicbNZC4ajGXZsmxMkmVbZhbXhqVloe8tlL4TDCOZToPLOl9Ii91oh6V1MATC21poV1YrgwqTAgMCsi1m7vF/u5qoiU9ycu+597m/+z/n3EP0ny83L5c4jkvZ/B/zPDb+/VWaKqllrYVOfHfiX2cOnj1IzavNpBxTpleKirKpoIBPTidRGtYT+5Y2uElKA7NgT7DJPy7IyuJnCTYXb06t83H88V55OfOFsC12ttB2gSyGUzzzOSkluaFia6vywyMfHdlfUJgvqFBWpA5VtVaxM5tgL8Hydp/eTbV9tRTgAnBDoQz8xctmOxyXmVaYCtUTiF7y9AeXHMGLndh+7kz/mTbLnGVAf0sfUIVUfsx9poQpoAlrAtqIdtAwZWgmevRIRouLIzQ93YVxqODBg8p0UE+2u+L+9u5xznbNEswm/iaxV/xy3WDddkmXpPT418e31XTXvCK7Ltt28vuTpbDt0l5pMQOW0MLCHpqc3EVLS+9uGRvbWkf09KenDlAk0bNnIOz75LLvymFckAngx4a4wai7qdOqQ2o95vr6WL1eF9VpodqI8SjRw4diWl0NUCLRTisrfrp/vwIKszmfg4Z/n/ugPxGWdnS5qgF8/lDroTrjtFGtvKGUI3xF/a16RUO8QQG4XDOh0QFYzcq2A8BqAPfTxkY1/K0A8pIIeaq2pnu0ScVZrjcFc5Divaa9u/A03pSPyN+QD8vLoLQMoDLFqGKHYkRRjnkJA1bR8vKXFI02Qd0XUPkOgHl8KHJKLnd8Y3OuSX6S/AiFGUi+GQp9AHQA6Db8YnA33m50Q2EH7AekoJGF/D6trWkBktK9e5qiubkyGdGzrMq9sdnP/Tej05euOdyC3PxnRMZKocQrKbQv2IXnufNCgIUojtCWtAnNs+bCY45jAlaU92hmRgWFpymZVOWvr7/+FMK14oWt/Ol5YSjkeNXjvlrC3p2sV+a1L9rjeCITCD1i/tUcMc4YI9qwdkIf1U9B7QUW8gG6e7eV4nEjcngW87dfI8phndB3I3rOPzp8+yt/W2dseZbHws7gZQhYh/6P5TDgTuRQDOBRhC6GX0qP20vgcCSuXuwMc6YBQz/8F6U90hbbvM2jn9Q7kTOX9Y7VBVUuVNcJld6GnxsaUr0LIAFIAKZ89fpvmabPrBS5My4djg26vH1eK2tXxZhip2nGtA9dIkKlRSiQCO9PpAqqROpx9T6A3/oLtDcDOlKGcSgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"hashmap buckets\"\n        title=\"hashmap buckets\"\n        src=\"/static/130e3347a853a23f466502dd9bd941a5/1e043/hashmap-bucket.png\"\n        srcset=\"/static/130e3347a853a23f466502dd9bd941a5/991de/hashmap-bucket.png 173w,\n/static/130e3347a853a23f466502dd9bd941a5/e4d6b/hashmap-bucket.png 345w,\n/static/130e3347a853a23f466502dd9bd941a5/1e043/hashmap-bucket.png 690w,\n/static/130e3347a853a23f466502dd9bd941a5/e3189/hashmap-bucket.png 1035w,\n/static/130e3347a853a23f466502dd9bd941a5/21b4d/hashmap-bucket.png 1280w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Source : <a href=\"https://en.wikipedia.org/wiki/Hash_table\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hash Table Wiki</a> </span></p>\n<br/>\n<p>HashTable은 Liked List의 사이즈의 대해서 효율성을 위해 Tree로 바꾼다거나 하는 로직은 찾아 볼 수 없습니다</p>\n<br/>\n<br/>\n<p><strong>다음으로 put의 코드를 살펴보겠습니다</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token class-name\">V</span> <span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">K</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">V</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  </span> \n        <span class=\"token comment\">// Make sure the value is not null</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">NullPointerException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token punctuation\">}</span></span>      \n        <span class=\"token comment\">// Makes sure the key is not already in the hashtable.</span>\n        <span class=\"token class-name\">Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> tab<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> table<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>     <span class=\"token keyword\">int</span> hash <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span>        <span class=\"token keyword\">int</span> index <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>hash <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x7FFFFFFF</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> tab<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n        <span class=\"token annotation punctuation\">@SuppressWarnings</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unchecked\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token class-name\">Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> entry <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span>tab<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        \n<span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> entry <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">;</span> entry <span class=\"token operator\">=</span> entry<span class=\"token punctuation\">.</span>next<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>entry<span class=\"token punctuation\">.</span>hash <span class=\"token operator\">==</span> hash<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> entry<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>                <span class=\"token class-name\">V</span> old <span class=\"token operator\">=</span> entry<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n                entry<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> old<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      \n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>     <span class=\"token function\">addEntry</span><span class=\"token punctuation\">(</span>hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">addEntry</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> hash<span class=\"token punctuation\">,</span> <span class=\"token class-name\">K</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">V</span> value<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> index<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span> tab<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> table<span class=\"token punctuation\">;</span>\n        \n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>count <span class=\"token operator\">>=</span> threshold<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token comment\">// Rehash the table if the threshold is exceeded</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token function\">rehash</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>      \n            tab <span class=\"token operator\">=</span> table<span class=\"token punctuation\">;</span>\n            hash <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            index <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>hash <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x7FFFFFFF</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> tab<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      \n        <span class=\"token comment\">// Creates the new entry.</span>\n        <span class=\"token annotation punctuation\">@SuppressWarnings</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unchecked\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token class-name\">Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> e <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span> tab<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        tab<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Entry</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        count<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n        modCount<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>HashMap과 다르게 간단한 put 구조를 가지고 있습니다</p>\n<br/>\n<p><span class='red_font'>(1)</span> <code class=\"language-text\">public synchronized V put(K key, V value)</code></p>\n<blockquote>\n<p>synchronized를 통해 thread-safe하게 설계된걸 확인 할 수 있습니다<br>\n이후 HashMap에서는 사용상에 thread-safe 구성이 효율적이지 않다고 삭제되었습니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(2)</span> <code class=\"language-text\">if (value == null) { throw new NullPointerException(); }</code></p>\n<blockquote>\n<p>HashMap과 다르게 value에 null을 허용하지 않습니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(3)</span> <code class=\"language-text\">int hash = key.hashCode();</code></p>\n<blockquote>\n<p>key값도 보조해시 없이 그냥 hashCode()를 사용합니다<br>\n때문제 key에서도 null이 허용되지 않습니다 (HashMap에서는 보조해시에서 null일 경우 0을 할당합니다)</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(4)</span> <code class=\"language-text\">for(; entry != null ; entry = entry.next)</code></p>\n<blockquote>\n<p>Entry를 탐색하며 값변경만을 적용합니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(5)</span> <code class=\"language-text\">addEntry(hash, key, value, index);</code></p>\n<blockquote>\n<p>addEntry를 통해 신규 Entry를 buckets에 삽입합니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(6)</span> <code class=\"language-text\">if (count >= threshold)</code></p>\n<blockquote>\n<p>buckets의 Entry사이즈를 확인하여 rehash() 여부를 결정합니다</p>\n</blockquote>\n<br/>\n<hr>\n<br/>\n<h2 id=\"concurrenthashmap병행해시맵\" style=\"position:relative;\"><a href=\"#concurrenthashmap%EB%B3%91%ED%96%89%ED%95%B4%EC%8B%9C%EB%A7%B5\" aria-label=\"concurrenthashmap병행해시맵 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ConcurrentHashMap(병행해시맵)</h2>\n<p>다음으로 알아볼 것은 ConcurrentHashMap 입니다<br>\nConcurrentHashMap의 핵심은 Unsafe를 사용한 <span class='red_font'>thread-safe</span>를 지원한다는 것입니다</p>\n<p><code class=\"language-text\">Unsafe</code>는 java 내부의 존재하는 thread-safe를 위해 존재하는 class입니다<br>\n내부적으로 AutoInteger, ConcurrentHashMap등의 thread-safe에 사용되며 일반적으로는 생성해서 사용하지 못하도록<br>\n<code class=\"language-text\">private static final Unsafe theUnsafe = new Unsafe();</code>로 생성자를 막아 두었습니다<br>\n해당 포스트에서는 다루지 않습니다 👉 <a href=\"https://www.baeldung.com/java-unsafe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">java-unsafe</a></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Unsafe</span> <span class=\"token class-name\">U</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">Unsafe</span><span class=\"token punctuation\">.</span><span class=\"token function\">getUnsafe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">static</span> <span class=\"token punctuation\">{</span>\n     <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n     \n     ABASE <span class=\"token operator\">=</span> <span class=\"token class-name\">U</span><span class=\"token punctuation\">.</span><span class=\"token function\">arrayBaseOffset</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token keyword\">int</span> scale <span class=\"token operator\">=</span> <span class=\"token class-name\">U</span><span class=\"token punctuation\">.</span><span class=\"token function\">arrayIndexScale</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     ASHIFT <span class=\"token operator\">=</span> <span class=\"token number\">31</span> <span class=\"token operator\">-</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span><span class=\"token function\">numberOfLeadingZeros</span><span class=\"token punctuation\">(</span>scale<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     \n     <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">tabAt</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> tab<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span><span class=\"token class-name\">U</span><span class=\"token punctuation\">.</span><span class=\"token function\">getObjectAcquire</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span>i <span class=\"token operator\">&lt;&lt;</span> ASHIFT<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> ABASE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">casTabAt</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> tab<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">,</span>\n                                  <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> c<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> v<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token class-name\">U</span><span class=\"token punctuation\">.</span><span class=\"token function\">compareAndSetObject</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span>i <span class=\"token operator\">&lt;&lt;</span> ASHIFT<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> ABASE<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ConcurrentHashMap는 내부의 thread-safe를 위해 조회와 삽입을 하는 메소드가 구현되어 있습니다<br>\ntabAt는 thread-safe하게 조회를 하고 casTabAt는 thread-safe하게 삽입시 성공여부에 따라 <code class=\"language-text\">true</code>, <code class=\"language-text\">false</code>를 return 합니다</p>\n<p>해당 메소드들을 통해 알 수 있듯이 HashTable과 다르게 각각의 Node의 대한 thread-safe 기술을 활용하여<br>\nHashMap의 thread-safe가 안되는 문제를 효율적으로 제어하였습니다</p>\n<br/>\n<br/>\n<p><strong>다음으로 put의 코드를 살펴보겠습니다</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> MOVED     <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// hash for forwarding nodes</span>\n\n <span class=\"token comment\">//보조 해시</span>\n <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token function\">spread</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> h<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n     <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">>>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> HASH_BITS<span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span>\n \n <span class=\"token comment\">//resize를 위한 Node</span>\n  <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ForwardingNode</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n     <span class=\"token keyword\">final</span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> nextTable<span class=\"token punctuation\">;</span>\n     <span class=\"token class-name\">ForwardingNode</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> tab<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n         <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>MOVED<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>nextTable <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">}</span>\n     \n     <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  <span class=\"token punctuation\">}</span>\n\n\n\n<span class=\"token keyword\">final</span> <span class=\"token class-name\">V</span> <span class=\"token function\">putVal</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">K</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">V</span> value<span class=\"token punctuation\">,</span> <span class=\"token keyword\">boolean</span> onlyIfAbsent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\"> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> value <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">NullPointerException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </span><span class=\"gatsby-highlight-code-line\"> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>    <span class=\"token keyword\">int</span> hash <span class=\"token operator\">=</span> <span class=\"token function\">spread</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </span>        <span class=\"token keyword\">int</span> binCount <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> tab <span class=\"token operator\">=</span> table<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> </span>            <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> f<span class=\"token punctuation\">;</span> <span class=\"token keyword\">int</span> n<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> fh<span class=\"token punctuation\">;</span> <span class=\"token class-name\">K</span> fk<span class=\"token punctuation\">;</span> <span class=\"token class-name\">V</span> fv<span class=\"token punctuation\">;</span>\n            \n<span class=\"gatsby-highlight-code-line\">            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tab <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">                tab <span class=\"token operator\">=</span> <span class=\"token function\">initTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>                \n<span class=\"gatsby-highlight-code-line\">            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>f <span class=\"token operator\">=</span> <span class=\"token function\">tabAt</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> i <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> hash<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">casTabAt</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>                   <span class=\"token comment\">// no lock when adding to empty bin</span></span>            <span class=\"token punctuation\">}</span>\n            \n<span class=\"gatsby-highlight-code-line\">            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>fh <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>hash<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> MOVED<span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">                tab <span class=\"token operator\">=</span> <span class=\"token function\">helpTransfer</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>onlyIfAbsent <span class=\"token comment\">// check first node without acquiring lock</span>\n                     <span class=\"token operator\">&amp;&amp;</span> fh <span class=\"token operator\">==</span> hash\n                     <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>fk <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> key <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>fk <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>fk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                     <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>fv <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>val<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">return</span> fv<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token class-name\">V</span> oldVal <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"> <span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span>           <span class=\"token keyword\">synchronized</span> <span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> </span>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">tabAt</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> f<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fh <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                            binCount <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n                            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> e <span class=\"token operator\">=</span> f<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>binCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                                <span class=\"token class-name\">K</span> ek<span class=\"token punctuation\">;</span>\n                                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>hash <span class=\"token operator\">==</span> hash <span class=\"token operator\">&amp;&amp;</span>\n                                    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>ek <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> key <span class=\"token operator\">||</span>\n                                     <span class=\"token punctuation\">(</span>ek <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>ek<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                                    oldVal <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>val<span class=\"token punctuation\">;</span>\n                                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>onlyIfAbsent<span class=\"token punctuation\">)</span>\n                                        e<span class=\"token punctuation\">.</span>val <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n                                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                                <span class=\"token punctuation\">}</span>\n                                <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> pred <span class=\"token operator\">=</span> e<span class=\"token punctuation\">;</span>\n                                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>e <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>next<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                                    pred<span class=\"token punctuation\">.</span>next <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                                <span class=\"token punctuation\">}</span>\n                            <span class=\"token punctuation\">}</span>\n                        <span class=\"token punctuation\">}</span>\n                        <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>f <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">TreeBin</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> p<span class=\"token punctuation\">;</span>\n                            binCount <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n                            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>p <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TreeBin</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">putTreeVal</span><span class=\"token punctuation\">(</span>hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span>\n                                                           value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                                oldVal <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>val<span class=\"token punctuation\">;</span>\n                                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>onlyIfAbsent<span class=\"token punctuation\">)</span>\n                                    p<span class=\"token punctuation\">.</span>val <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n                            <span class=\"token punctuation\">}</span>\n                        <span class=\"token punctuation\">}</span>\n                        <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>f <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">ReservationNode</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalStateException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Recursive update\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>binCount <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>binCount <span class=\"token operator\">>=</span> TREEIFY_THRESHOLD<span class=\"token punctuation\">)</span>\n                        <span class=\"token function\">treeifyBin</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>oldVal <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token keyword\">return</span> oldVal<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\"> <span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>    <span class=\"token function\">addCount</span><span class=\"token punctuation\">(</span><span class=\"token number\">1L</span><span class=\"token punctuation\">,</span> binCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </span>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p><span class='red_font'>(1)</span> <code class=\"language-text\">if (key == null || value == null) throw new NullPointerException();</code></p>\n<blockquote>\n<p>HashMap과 다르게 null을 허용하지 않습니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(2)</span> <code class=\"language-text\">int hash = spread(key.hashCode());</code></p>\n<blockquote>\n<p>spread()는 보조해시 함수로 이전에 본 HashMap과 크게 다르지 않습니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(3)</span> <code class=\"language-text\">for (Node&lt;K,V>[] tab = table;;)</code></p>\n<blockquote>\n<p>ConcurrentHashMap는 값 삽입시 thread끼리 충돌이 날수 있기 때문에 재시도를 위해 for문으로 시작됩니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(4)</span> <code class=\"language-text\">if (tab == null || (n = tab.length) == 0)</code></p>\n<blockquote>\n<p>buckets의 초기 세팅이 필요한경우 buckets을 생성합니다<br>\nHashMap과 똑같인 DEFAULT_CAPACITY = 16의 LOAD_FACTOR = 0.75f을 기본값으로 가집니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(5)</span> <code class=\"language-text\">else if ((f = tabAt(tab, i = (n - 1) &amp; hash)) == null)</code></p>\n<blockquote>\n<p><code class=\"language-text\">tabAt</code>을 통해 Node가 처음 삽입되는 값인지 확인합니다<br>\n<code class=\"language-text\">casTabAt</code>통해 값을 삽입하며 삽입시점에 buckets의 값이 null인지 확인하여 성공시 true, 실패시 false를 리턴합니다<br>\n삽입에 실패하면 <span class='red_font'>(3)</span> for문으로 돌아가 재시도 합니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(6)</span> <code class=\"language-text\">else if ((fh = f.hash) == MOVED)</code></p>\n<blockquote>\n<p>hash값이 MOVED(-1)인지를 검사합니다(ForwardingNode의 hash값)<br>\nhelpTransfer()를 실행하여 리사이즈를 진행합니다</p>\n</blockquote>\n<br/>\n<p><span class='red_font'>(7)</span> <code class=\"language-text\">synchronized (f)</code></p>\n<blockquote>\n<p>탐색시에 synchronized를 사용하여 해당 Node의 LinkedList, Tree의 대한 thread-safe를 보장합니다</p>\n</blockquote>\n<p><span class='red_font'>(8)</span> <code class=\"language-text\">addCount(1L, binCount);</code></p>\n<blockquote>\n<p>size를 측정하여 transfer로 리사이즈를 진행하고 ForwardingNode을 할당합니다</p>\n</blockquote>\n<br/>\n<hr>\n<br/>\n<h2 id=\"hash-collision해시-충돌\" style=\"position:relative;\"><a href=\"#hash-collision%ED%95%B4%EC%8B%9C-%EC%B6%A9%EB%8F%8C\" aria-label=\"hash collision해시 충돌 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hash Collision(해시 충돌)</h2>\n<p>다음은 해시들의 충돌을 해결하는 방법을 2가지 제시합니다</p>\n<br/>\n<h3 id=\"separate-chaining분리-연결법\" style=\"position:relative;\"><a href=\"#separate-chaining%EB%B6%84%EB%A6%AC-%EC%97%B0%EA%B2%B0%EB%B2%95\" aria-label=\"separate chaining분리 연결법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Separate Chaining(분리 연결법)</h3>\n<p>가장 널리 사용되고 있는 분리 연결법입니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.28901734104046%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACx0lEQVQoz22Sa0iTURiA322siLQbZSQogYR/ooQwgvpj2Q8RKiIiEn8EBREEo6KYtPsqxHQ6UjeWutzmNr42L9k2ndaUtTm3Lzd2+bY5NTWdNpt4r8hOZ2b1o154zuEcznnO+/IeAIeDBkVFTKiooGcjBKmYQAQMB12wPLwGCO/9JuqIQsgWAvZtNqRtT0sd3Ys5gjkAf+KXJGM3Hphy+cZWEunSg56+zJnBRDaXxc0vvVBaKOFLjiZ9yaweVc8etPnwpvAYZv9f4fx8DoyPn6BNx/OZCKWe3arWOfVGsmepfbwVGSJGZIwZUVusDREUgZQupcyasIIlbmHAf2Nu7hqMjclgerrqoM2WdxyAQZip+y8Hu18booTTEDbYsciO5359QO9vdDbeG1gYAOI7sUWalDJkX2UMxbqCUbtUy2hADXSA5eVzOMMyLL6zz2bLTRXjcGsvub1vHlKjkcf+qF/sDXlF1BglIgNkVZet67xySAnSdSlI56WAhRvUfK6B+rV6fHtl5TJEIk9gaooPi4s5PwB2Oq4LDKrWp6hypAZVByRIGpWi6lA1kgQlSNgnbCp5XnJS4BdUsZ1sAW+IJ+L7+AK2g13O8/JKUsKrkEhUYpk4q6Mj7wzALnWzW653maKamGpWE2mJ68Z0cU1Y81EdUX+pc9Q9KlYUZ4iCoiIsKhAGhKexvIDn453Fa9zxmZmL4PXyYXT0QTpBHMY506LrrlMe37sbIR911+/1s0gnyaKCFIt0kWyrxVrY7GiGsnAZCAICEIfFG2ApiEIifH119QrEYuUwOyvEHGICbHuh8rbqPF3f9BMtSBvTId0HzIgO4QyR3CNXmBfM0DTZxOS4OHRcMp37nkvneDgpaKl/SMcwdmBSTc/MBZrprfOWmexVWSPdryxBS5spYGq3UlZjp6+zV9uvvWmftIP7k5vOe8b759P8BI2AlQfbDrhhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"separate-chaining\"\n        title=\"separate-chaining\"\n        src=\"/static/7be89f0660af9d61a94e65f17b8ae124/1e043/separate-chaining.png\"\n        srcset=\"/static/7be89f0660af9d61a94e65f17b8ae124/991de/separate-chaining.png 173w,\n/static/7be89f0660af9d61a94e65f17b8ae124/e4d6b/separate-chaining.png 345w,\n/static/7be89f0660af9d61a94e65f17b8ae124/1e043/separate-chaining.png 690w,\n/static/7be89f0660af9d61a94e65f17b8ae124/e3189/separate-chaining.png 1035w,\n/static/7be89f0660af9d61a94e65f17b8ae124/b1001/separate-chaining.png 1380w,\n/static/7be89f0660af9d61a94e65f17b8ae124/29114/separate-chaining.png 1920w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span><br>\n<span class='img_caption'>Source : <a href=\"https://en.wikipedia.org/wiki/Hash_table\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hash Table Wiki</a> </span></p>\n<p>새로 값을 삽입할때 해시의 buckets의 같은 공간에 이미 값이 존재하고<br>\n해당 key와 value의 값이 삽입되야하는 값과 다르다면 값을 저장하는 모델(Node)을 만들고<br>\nLinked List, Tree등의 자료구조를 사용하여 연결하여 삽입하는 방법입니다</p>\n<br/>\n<h3 id=\"open-addressing개방-주소법\" style=\"position:relative;\"><a href=\"#open-addressing%EA%B0%9C%EB%B0%A9-%EC%A3%BC%EC%86%8C%EB%B2%95\" aria-label=\"open addressing개방 주소법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Open Addressing(개방 주소법)</h3>\n<p>개방 주소법은 buckets을 그대로 사용합니다<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 690px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.70520231213872%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAEsElEQVQ4y3WUa0xbZRjHn3ZbtgjGOIwazZTFjsumxsQPi8Y4TfSD2aIuLpuJYYubl+yDm9coDNyANXJxYQbL2HDrCgVaoKQwxqE1XEqhtKWX0/ZA20NvlJaWe5GCtSs8vqcj8ZNv8j/veZ5zzu88l/d9Af5nKPvvgbSrFfrHh3i/i2/w3QssDxF5cYzzuZkItsVLYIK/hVv8SCrCe/j1rl07yfUQ8HhZaTszE76/egGOf/weL4YstPaJYGaeTQM0Wg33RgZRHtFznG9+ZT79LBqKEhf5A3R374TDhzPh2LE9xOZnh0K8Dsmv/MraMgiuu1/XufpFOptWSLtsLQ6PQ2pxWeTDhmGlWqNW0G66lfExjVantUs9pD7OAQEiEYDhYYDRUYBYDPZtp0PG7ht3ND91dAbWpON97pZwEzZ5mvCu6y7KwjKUTktR6peieFKMjZ5GvO28XcYBj8LqajOEQvUQCNyCtbU7exOJl/BhMfa099i/6+71YptJPaMItWObtx1lrAwVQQXKvDJs97ejfEqeniWMpIIDHoGVlWoIBq+A11sK8fjVgyx76ArA3ljVVzAXt71ocvd9O27XnptgJ4sYlrk06ZkscrgchXqTvpC7Z6aYQofbUTagGXiDA74KicRFkuoXsLT0JWxtnQeTSSADeGLwuhAsmNqv+zt6cthpPWqfpAvMjOWMdcJ6mp6gC0YMIwU2p63AZDedJr7P1APqlzngByTlThKdGJxOCUm5FTY2XiEp888A7GDb7l50NDXgn5qWMBVWIeWnsNffi9Q0hUq3EqkAlRbnk9PyKg6YD8nkJ7C4+BEBnyARnoJU6imuWVqA7GC+4NLsfkFIfutTy8+RX1KXLIXJIrooKQwKkxWzFcnSqdJkCVOyQWYs95UXc8BTsL4+BB6PkjSlGzY3KfD7XyMRPkqTOlpOnP/a8P43c+K2Ero8WrFVYilOXZ64nKqarUpVhitTZWxZqpguTgi9QhT6hCUc8HmS4rukGUdIHd8m9lsHGxv3tQHsr6GS0DGYPNcin//ntpFixXN/oIipIxKhJCrBhukGvDl1E+ucddjgb0CRS1TOAc/C8rKLRKgjddQTsOXJhYU3rQBZuGgHZ8j+oWnKODTqGJFZfVYL7afNdIA2mz1m84h9xGybtnG2kdge9Zj6cw6YRWqYT9LO4W1u5hI756RC8dgPBEjWIW85SWfo2a5sVb9yX989VY68WZ6nkCnyqB7qQGdHZ05PV09uq7Q1n7pH5TU3NmdxwAskqlUSnRd8vgCBR55eWnqH1DB9ADiCvrNa2rox4NAyhrABjWFjWvoZPQ66BtEQMqBhxpAamx7DXkvvZQ64i3Q2ExYWMkhTMnjxeCbx7djeeo9XXtMWSiUri3W6bqZuvharbFV4zXkN6+fqsTZYi9e917Gaqd6qYWuwxlNz5eFefvAAIBwGYFkgwLRvkxwSnqUQGN306RH7uH/QPjxqCOj/0vv0Mb1fHxvzjcUGmIGYMWCMGfyGRZ1Xh/eN93/8D8iB1taArEHYTXx3fiuC7qEWiD6YesS7Sj+j0vQ8S6moA+pBtYDsCAGlpgQKpUKg6ldxeoHYuc2y5r3/AtfvNC9O7n7CAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"open-addressing\"\n        title=\"open-addressing\"\n        src=\"/static/f201f9ad687bb6cf37b024b6c3728994/1e043/open-addressing.png\"\n        srcset=\"/static/f201f9ad687bb6cf37b024b6c3728994/991de/open-addressing.png 173w,\n/static/f201f9ad687bb6cf37b024b6c3728994/e4d6b/open-addressing.png 345w,\n/static/f201f9ad687bb6cf37b024b6c3728994/1e043/open-addressing.png 690w,\n/static/f201f9ad687bb6cf37b024b6c3728994/2bef9/open-addressing.png 1024w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span><br>\n<span class='img_caption'>Source : <a href=\"https://en.wikipedia.org/wiki/Hash_table\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hash Table Wiki</a> </span></p>\n<p>해시의 buckets의 같은 공간에 이미 값이 존재한다면 새로운 주소로 buckets에 값을 할당하는 방식입니다<br>\n새로운 주소를 구하는 방법은 여러 방식이 존재합니다</p>\n<blockquote>\n<ol>\n<li>고정폭을 가지고 삽입하고 값을 이동시킨다</li>\n<li>처음엔 1만큰 이후에 2^2, 3^2 만큼 옮기는 방식</li>\n<li>해시값을 한번더 해싱하여 새로운 주소로 값을 삽입합니다</li>\n</ol>\n</blockquote>\n<br/>\n<p><strong>서로의 방식에는 장단점이 있습니다</strong></p>\n<p>Separate Chaining의 경우 buckets자체의 확장이 필요없고 삽입과 삭제가 손쉽게 가능합니다<br>\n단점으로는 <span class='red_font'>List 및 Tree의 길이가 늘어날수록 탐색의 효율이 떨어지게</span> 됩니다</p>\n<br/>\n<p>Open Addressing이 추가 메모리 할당 없이 buckets자체를 사용하게 됩니다<br>\n단점으로 <span class='red_font'>삽입과 탐색시 효율이 떨어지며 삭제시 빈공간의 대한 buckets 재정리 작업</span>이 필요합니다</p>\n<hr>\n<h2 id=\"마무리\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"마무리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마무리</h2>\n<p>HashTable의 충돌발생시 해결법을 알고 있느냐는 질문을 받았습니다<br>\n그때 당시 Separate Chaining(분리 연결법)의 방법을 알고 있었지만,<br>\n충돌자체를 thread-safe여부로 받아들여 HashTable은 충돌이 발생하지 않는 걸로 알고 있다고 답해버렸습니다 😭</p>\n<p>이를 계기로 명확하게 구조를 보고 정리하는 시간을 갖게 되었습니다 👋</p>\n<hr>\n<br/>\n<h2 id=\"관련-참고\" style=\"position:relative;\"><a href=\"#%EA%B4%80%EB%A0%A8-%EC%B0%B8%EA%B3%A0\" aria-label=\"관련 참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>관련 참고</h2>\n<p><a href=\"https://en.wikipedia.org/wiki/Hash_table\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hash table 위키</a><br>\n<a href=\"https://d2.naver.com/helloworld/831311\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">네이버 D2 포스팅</a><br>\n<a href=\"https://mangkyu.tistory.com/102\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">망나니개발자님 블로그</a><br>\n<a href=\"https://velog.io/@alsgus92/ConcurrentHashMap%EC%9D%98-Thread-safe-%EC%9B%90%EB%A6%AC\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">alsgus92.log</a><br>\n<a href=\"https://hongjw1938.tistory.com/17?category=884192\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">겐지충프로그래머님 블로그</a>  </p>","frontmatter":{"title":"[DataStructure] HashMap, HashTable과 ConcurrentHashMap 차이점","date":"July 30, 2022"}}},"pageContext":{"slug":"/data-structure/hashtable/","previous":{"fields":{"slug":"/spring/spring-version-upgrade/"},"frontmatter":{"title":"[Spring] Spring Boot 2.3.x Dependency 업그레이드","category":"Spring"}},"next":{"fields":{"slug":"/spring/proxy/spring-bean-post-processor/"},"frontmatter":{"title":"[Spring] Spring Proxy의 빈 후처리기(BeanPostProcessor)","category":"Spring"}}}},"staticQueryHashes":["3128451518","96099027"]}