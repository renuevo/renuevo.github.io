{"componentChunkName":"component---src-templates-blog-post-js","path":"/spring/batch/spring-batch-chapter-2/","webpackCompilationHash":"3df586c2989763fc81aa","result":{"data":{"site":{"siteMetadata":{"title":"renuevo blog","author":"deokhwa kim","siteUrl":"https://renuevo.github.io","comment":{"disqusShortName":"https-renuevo-github-io","utterances":""},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"b2e8e369-9e26-5597-ad36-909be8146525","excerpt":"Chapter 2에서는 Spring Batch의 File ItemReader에 대한 이야기를 다룹니다   앞서 본것과 같이 Chunk 지향처리 의 구성요소로 이루어져 있습니다   ItemReader   ItemProcessor   ItemWriter   지금부터 이 3가지 요소의 대해 알아보도록 하겠습니다   ItemReader 기본적으로 Spring Batch는 다음과 같은 흐름으로 많이 사용합니다   Data -> ItemReader -> ItemProcessor -> ItemWriter…","html":"<p><em>Chapter 2에서는 Spring Batch의 File ItemReader에 대한 이야기를 다룹니다</em>  </p>\n<br/>\n<p>앞서 본것과 같이 Chunk 지향처리 <code class=\"language-text\">3가지</code>의 구성요소로 이루어져 있습니다  </p>\n<ol>\n<li>ItemReader  </li>\n<li>ItemProcessor  </li>\n<li>ItemWriter  </li>\n</ol>\n<p>지금부터 이 3가지 요소의 대해 알아보도록 하겠습니다  </p>\n<h2 id=\"itemreader\"><a href=\"#itemreader\" aria-label=\"itemreader permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ItemReader</h2>\n<p>기본적으로 Spring Batch는 다음과 같은 흐름으로 많이 사용합니다  </p>\n<br/>\n<p><strong>Data -> ItemReader -> ItemProcessor -> ItemWriter -> Data</strong></p>\n<br/>\n<p>여기서 <code class=\"language-text\">ItemReader</code>는 데이터를 읽어 들이는 역할을 합니다<br>\nSpring Batch에서는 다양한 데이터를 읽어 올 수 있도록 기본적인 구현체를 제공하고 있습니다<br>\n또한  사용자 개인이 커스텀하여 다양한 형태의 데이터도 읽어 올 수 있도록 확장성도 열어 두었습니다  </p>\n<br/>\n<h3 id=\"itemreader의-기본-구성\"><a href=\"#itemreader%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EA%B5%AC%EC%84%B1\" aria-label=\"itemreader의 기본 구성 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ItemReader의 기본 구성</h3>\n<p>먼저 가장 기본적인 SpringBatch의 ItemReader인 <code class=\"language-text\">JdbcPagingItemReader</code> 살펴 보며 ItemReader의 구조를 알아 보겠습니다<br>\n<br/></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 560px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAACQElEQVQ4y3VTiXKrMAzkYwLG2JwJpwED4TZn0rT9/y+pTPo6b3poNB5jtPLuIhRCiGEYrmfHic+SKGVxHAX0OPTONmM+i6MsS8LQJz9CIZRgbMTssr5Wt028vm2TaCkluo4ZD5Zbdb/N7+/3vqug3XcwHOm6jjRsOhQ2xDaoBRdT48AjTacOdNd/AA+w67kZZzyPC0jOCp5GoR/GXlEmRZ7yPCnLjOfMssyfeMUPg2Hplqm5Px6323K/zyXPsmso5mpfxf0xw+G6DI5j/0IbnCEGQZK3j6inqpoGD5quqUgHQRQUIeNX0hJMQBK+BEFV521bN3XZ1Ly58rYpu66C9XL28J9g6TYO4qgXtRgbMdTLvgNR8HyehmUefP8swfTvmxGSPFUNqacTIq6GqXpSQQIkQggKAI6lDPwvwX9DoZRWbTWO9TS2cPMkOrgT9vPUH2u3LmNV5hE790M+9ge74+357EpwXuQ16KyLQ3AxiLkfR9i0DWiuhr7Oc+ZHXifyrq/qayHmpu9rz3UkbTkkCBJJ8pK2AwYD6dMJnIdUgSY4JscGS/MxxVAuaQOYPoMQ07LbqV2XflvFtgyw7rt4vGzNtXh+LXrUmtaz/DDsK+AozROYKp7F105UTct5CoKTOPwqkA0s+jRf+ea+LgPIIUxsTB1smLAe3mJJ3CSQpvX53RT6X3y2P5IYmFpWt43r2r+8bPBv3fb57XWHETLw58wotm07juO6Lmy+sYB2EYtYEqZpkqYxY3GWsTC4fBV8AN0N0EgD9CtxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JdbcPaingItemReader UML_1\"\n        title=\"JdbcPaingItemReader UML_1\"\n        src=\"/static/b10d0e6be9425047377370e3036ffebd/02744/JdbcPagingItemReader-1.png\"\n        srcset=\"/static/b10d0e6be9425047377370e3036ffebd/acf4b/JdbcPagingItemReader-1.png 173w,\n/static/b10d0e6be9425047377370e3036ffebd/fc834/JdbcPagingItemReader-1.png 345w,\n/static/b10d0e6be9425047377370e3036ffebd/02744/JdbcPagingItemReader-1.png 560w\"\n        sizes=\"(max-width: 560px) 100vw, 560px\"\n        loading=\"lazy\"\n      />\n    </span>  </p>\n<p>보시는 것과 같이 <code class=\"language-text\">JdbcPagingItemReader</code>는 여러 Class와 Interface를 상속받아 구현되어 있습니다<br>\n여기서 눈여겨 볼것은 상위에 위치되어 있는 <code class=\"language-text\">ItemStream</code>와 <code class=\"language-text\">ItemReader</code> 인터페이스입니다  </p>\n<br/>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.949999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABcRAAAXEQHKJvM/AAABb0lEQVQoz41S6XqCMBDsyygkhEOECoIgIOKBgFqP9mvf/zGmG+vRFnv8mG/zbXYnOzt50DQNV3AOTlFQdJlKYHAoOipBnilanS6hgx6dZQ+nWtl34Xj4QigLCAbjqFIf22aBdVmgmiVY5jFsy0ASe8iSCENdQNAj/DxIi5CfkzIaKsMhj/C8X2HXzLCrp9iscrg9CwvKz4sEofEH4VWyEDAJI9NAaJvwhYbA0jE0dbicwVYU9FUJKZn/TqgoKuLREPvdEk09x6qcYDGLUZUZPM+FenpQO4Gd13PZe4tQELpEOI0CvB4r7J9K7DcLNMsE2zpHloaIxz6KaYqYak5E/KbsR8IiCvH2ssbxsMZhV2FTF2ROgTDwaBKOnm3B0PWT3O+GtiRLQyzanevY6PdtDPwAnu9j8OjAJkMMupNEjPHbzjm/T3i5YPyjQZHLd/pI04iQIMvGyCdjWJZ5+xH/mbAlg3LCMKGR85+/1j25Eu+XMDu5GjzS9AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JdbcPaingItemReader UML_2\"\n        title=\"JdbcPaingItemReader UML_2\"\n        src=\"/static/eac1d0262464681265db47e54b2fa510/36727/JdbcPagingItemReader-2.png\"\n        srcset=\"/static/eac1d0262464681265db47e54b2fa510/acf4b/JdbcPagingItemReader-2.png 173w,\n/static/eac1d0262464681265db47e54b2fa510/fc834/JdbcPagingItemReader-2.png 345w,\n/static/eac1d0262464681265db47e54b2fa510/36727/JdbcPagingItemReader-2.png 690w,\n/static/eac1d0262464681265db47e54b2fa510/17fa4/JdbcPagingItemReader-2.png 1035w,\n/static/eac1d0262464681265db47e54b2fa510/a5044/JdbcPagingItemReader-2.png 1380w,\n/static/eac1d0262464681265db47e54b2fa510/d40c8/JdbcPagingItemReader-2.png 2000w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n    </span>   </p>\n<p>먼저 2개의 인터페이스중 ItemReader를 먼저 살펴 보겠습니다  </p>\n<br/>\n<p><strong>1. ItemReader는 Step에서 요구하는 필수적인 인터페이스입니다</strong>  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">T</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">UnexpectedInputException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ParseException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">NonTransientResourceException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> </code></pre></div>\n<p>내부도 간단하게 Step에서 사용할 데이터를 가져오는 Read에 대한 역할에 충실하고 있습니다<br>\nStep은 이런 ItemReader를 받아와서 데이터 Reader 업무를 수행합니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">SimpleStepBuilder</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">I</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">O</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">reader</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">I</span><span class=\"token punctuation\">></span></span> reader<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>reader <span class=\"token operator\">=</span> reader<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>   </code></pre></div>\n<p>사용자 지정 Reader를  ItemReader를 구현할때 상속받아 read() 부분을 구현하시면 됩니다  </p>\n<br/>\n<p><strong>2. 다음은 ItemStream 입니다</strong><br>\n구성은 다음과 같이 3가지의 메소드를 가지고 있습니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ItemStream</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">void</span> <span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ExecutionContext</span> executionContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">ItemStreamException</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ExecutionContext</span> executionContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">ItemStreamException</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">ItemStreamException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>ItemStream은 주기적으로 상태를 업데이트하고 오류가 발생하면 복원상태를 확인 가능하게 합니다</strong><br>\nopen과 close는 Stream에 열고 닫음을 설정합니다<br>\nupdate는 상태를 주기적으로 업데이트 하는 역할을 담당합니다  </p>\n<br/>\n<p>기본 구성은 다음과 같고 다음으로 Spring Batch에서 제공하는 기본적인 ItemReader들과 커스텀 구현을 알아 보도록 하겠습니다  </p>\n<br/>\n<hr>\n<h2 id=\"spring-batch의-itemreader\"><a href=\"#spring-batch%EC%9D%98-itemreader\" aria-label=\"spring batch의 itemreader permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spring Batch의 ItemReader</h2>\n<p>Spring Batch에서 제공하는 ItemReader는 2가지의 유형으로 나눠서 설명드리겠습니다  </p>\n<p><strong>1. File 형식의 데이터 Reader (txt, csv, xml, json)</strong><br>\n<strong>2. DB접근을 통한 데이터 Reader</strong>  </p>\n<p>DB접근을 통한 데이터 Reader는 Chapter 3에서 설명드릴 예정입니다<br>\nChapter 2에서는 File Reader에 대해서 살펴보도록 하겠습니다  </p>\n<hr>\n<h3 id=\"file-reader\"><a href=\"#file-reader\" aria-label=\"file reader permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>File Reader</h3>\n<p><strong>1. Txt 파일 ItemReader</strong> 👉 <a href=\"https://github.com/renuevo/spring-boot-in-action/blob/master/spring-boot-batch-in-action/src/main/java/com/github/renuevo/config/TxtFileItemReaderJobConfig.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Code</a><br>\ntxt 파일의 아이템 Reader는 <strong>FlatFileItemReader</strong>를 통해 Read 할 수 있습니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Bean</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ItemVo</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">txtFileItemReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ItemVo</span><span class=\"token punctuation\">></span></span> flatFileItemReader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    flatFileItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setResource</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ClassPathResource</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sample.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span><span class=\"gatsby-highlight-code-line\">    flatFileItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setLineMapper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">,</span> lineNumber<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ItemVo</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span>    <span class=\"token keyword\">return</span> flatFileItemReader<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>setResource로 Read할 파일의 Resource를 지정해줍니다<br>\n그러면 Step에서 Read할때 Line으로 데이터를 Read하게 됩니다<br>\n<strong>Read하는 데이터를 내부적으로 LineMapper를 통해 Mapping을 진행하게 되며 setLineMapper를 통해 LineMapper를 지정해 주면됩니다</strong>   </p>\n<br/>\n<p><span class='code_header'>LineMapper</span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">LineMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token class-name\">T</span> <span class=\"token function\">mapLine</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> line<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> lineNumber<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>LineMapper는 2가지의 파라미터를 받게 되는데 line은 한줄의 데이터를 lineNumber는 해당데이터의 라인번호를 의미합니다<br>\n이를 토대로 Mapper를 프로세스에 맞게 만들어서 설정 가능합니다  </p>\n<br/>\n<hr>\n<p><strong>2. Csv 파일 ItemReader</strong>  👉 <a href=\"https://github.com/renuevo/spring-boot-in-action/blob/master/spring-boot-batch-in-action/src/main/java/com/github/renuevo/config/CsvFileItemReaderJobConfig.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Code</a>  </p>\n<p>Csv파일도 txt파일을 읽어오는것과 별반 다르지 않습니다<br>\nFlatFileItemReader를 통해서 LineMapper만 수정해서 받아오면 됩니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Bean</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CsvItemVo</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">csvFileItemReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CsvItemVo</span><span class=\"token punctuation\">></span></span> flatFileItemReader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    flatFileItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setResource</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ClassPathResource</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sample_data.csv\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    flatFileItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setLinesToSkip</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    </span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token class-name\">DefaultLineMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CsvItemVo</span><span class=\"token punctuation\">></span></span> defaultLineMapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultLineMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span>\n    <span class=\"token class-name\">DelimitedLineTokenizer</span> delimitedLineTokenizer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DelimitedLineTokenizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    delimitedLineTokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">setNames</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"number\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"item\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">BeanWrapperFieldSetMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CsvItemVo</span><span class=\"token punctuation\">></span></span> beanWrapperFieldSetMapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BeanWrapperFieldSetMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    beanWrapperFieldSetMapper<span class=\"token punctuation\">.</span><span class=\"token function\">setTargetType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CsvItemVo</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    defaultLineMapper<span class=\"token punctuation\">.</span><span class=\"token function\">setLineTokenizer</span><span class=\"token punctuation\">(</span>delimitedLineTokenizer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    defaultLineMapper<span class=\"token punctuation\">.</span><span class=\"token function\">setFieldSetMapper</span><span class=\"token punctuation\">(</span>beanWrapperFieldSetMapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">    flatFileItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setLineMapper</span><span class=\"token punctuation\">(</span>defaultLineMapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span>    <span class=\"token keyword\">return</span> flatFileItemReader<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>예제에서는 flatFileItemReader에 setLinesToSkip을 설정해서 Header라인인 첫라인을 무시했습니다<br>\n그리고 <code class=\"language-text\">DefaultLineMapper</code>를 통해서 Csv파일을 VO Class로 바인딩 해줍니다<br>\n내부적으로 <code class=\"language-text\">DefaultLineMapper</code>는 mapLine을 통해서 데이터를 Mapping 합니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token annotation punctuation\">@Override</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">T</span> <span class=\"token function\">mapLine</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> line<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> lineNumber<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">\t\t<span class=\"token keyword\">return</span> fieldSetMapper<span class=\"token punctuation\">.</span><span class=\"token function\">mapFieldSet</span><span class=\"token punctuation\">(</span>tokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    </span>\t<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위에 소스를 보시면 Tokenizer를 통해 Line을 분류하고 MapfieldSet을 통해 데이터를 바인딩하는것을 알 수 있습니다<br>\n그래서 <strong>DelimitedLineTokenizer에 Tokenizer와 FieldSetMapper를 설정해 주어야 합니다</strong>  </p>\n<br/>\n<p><strong>Tokenizer부터 살펴보겠습니다</strong>  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">DelimitedLineTokenizer</span> delimitedLineTokenizer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DelimitedLineTokenizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndelimitedLineTokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">setNames</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"number\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"item\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Tokenizer는 <code class=\"language-text\">DelimitedLineTokenizer</code>를 사용했습니다<br>\nsetNames를 통해 각각의 데이터의 이름만을 설정해주고 사용하였습니다<br>\n<code class=\"language-text\">DelimitedLineTokenizer</code>는 내부적으로 <code class=\"language-text\">,</code>를 구분자로 가지고 있어서 Csv를 Read할 경우 바로 사용 가능합니다<br>\n만약 다른 구분자가 다른 데이터를 가지고 올 경우에는 setDelimiter로 변경 가능합니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DelimitedLineTokenizer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AbstractLineTokenizer</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">InitializingBean</span> <span class=\"token punctuation\">{</span>\n    \n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n<span class=\"gatsby-highlight-code-line\">\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> DELIMITER_COMMA <span class=\"token operator\">=</span> <span class=\"token string\">\",\"</span><span class=\"token punctuation\">;</span>    </span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">DelimitedLineTokenizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">(</span>DELIMITER_COMMA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setDelimiter</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> delimiter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>    </span>\t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>delimiter <span class=\"token operator\">=</span> delimiter<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p><strong>다음으로 FieldSetMapper입니다</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">BeanWrapperFieldSetMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CsvItemVo</span><span class=\"token punctuation\">></span></span> beanWrapperFieldSetMapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BeanWrapperFieldSetMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbeanWrapperFieldSetMapper<span class=\"token punctuation\">.</span><span class=\"token function\">setTargetType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CsvItemVo</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>FieldSetMapper는 Tokenizer에서 가지고온 데이터들을 VO로 바인드하는 역할을 합니다<br>\n기본적인 <code class=\"language-text\">BeanWrapperFieldSetMapper</code>을 사용하였고 <code class=\"language-text\">setTargetType</code>을 통해 class를 넘겨주면 내부에서 newInstance를 통해 객체를 생성해서 데이터를 바인드하고 return 합니다   </p>\n<br/>\n<p><strong>이 두개의 기능을 DefaultLineMapper을 통해서 FlatFileItemReader에 전달하면 간편하게 Csv를 읽을 수 있습니다</strong>  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">defaultLineMapper<span class=\"token punctuation\">.</span><span class=\"token function\">setLineTokenizer</span><span class=\"token punctuation\">(</span>delimitedLineTokenizer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndefaultLineMapper<span class=\"token punctuation\">.</span><span class=\"token function\">setFieldSetMapper</span><span class=\"token punctuation\">(</span>beanWrapperFieldSetMapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><del>이들을 활용하면 왠만한 File들은 전부 쉽게 읽을 수 있습니다</del></p>\n<p>마지막으로 위의 소스들은 익명클래스를 활용해서 간단하게 구현도 가능합니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Bean</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CsvItemVo</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">csvFileItemReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CsvItemVo</span><span class=\"token punctuation\">></span></span> flatFileItemReader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    flatFileItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setResource</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ClassPathResource</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sample_data.csv\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    flatFileItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setLinesToSkip</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    flatFileItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setLineMapper</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultLineMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">setLineTokenizer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DelimitedLineTokenizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token function\">setNames</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"number\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"item\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">setFieldSetMapper</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BeanWrapperFieldSetMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token function\">setTargetType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CsvItemVo</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> flatFileItemReader<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<hr>\n<p><strong>3. XML 파일 ItemReader</strong> 👉 <a href=\"https://github.com/renuevo/spring-boot-in-action/blob/master/spring-boot-batch-in-action/src/main/java/com/github/renuevo/config/XmlFileItemReaderJobConfig.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Code</a></p>\n<p>XML은 앞서 설명드린 FlatFileItemReader와 달리 다른 Class를 사용합니다<br>\n여기서는 <a href=\"https://docs.spring.io/spring/docs/current/spring-framework-reference/data-access.html#oxm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring OXM</a>을 통해 XML을 읽는 방법을 소개 합니다  </p>\n<br/>\n<p>Reader에서 사용할 Sample XML 파일을 준비합니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>items</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>number</span><span class=\"token punctuation\">></span></span>1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>number</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>data</span><span class=\"token punctuation\">></span></span>one<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>data</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>number</span><span class=\"token punctuation\">></span></span>2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>number</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>data</span><span class=\"token punctuation\">></span></span>two<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>data</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>3<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>number</span><span class=\"token punctuation\">></span></span>3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>number</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>data</span><span class=\"token punctuation\">></span></span>three<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>data</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>4<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>number</span><span class=\"token punctuation\">></span></span>4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>number</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>data</span><span class=\"token punctuation\">></span></span>four<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>data</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>items</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>그리고 자신의 버젼에 맞는 의존관계 설정이 필요합니다<br>\n아래 그림과 간이 <code class=\"language-text\">xstream</code>과 <code class=\"language-text\">spring-oxm</code>을 gradle에 추가해 줍니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"groovy\"><pre class=\"language-groovy\"><code class=\"language-groovy\">dependencies <span class=\"token punctuation\">{</span>\n <span class=\"token punctuation\">...</span>\n implementation group<span class=\"token punctuation\">:</span> <span class=\"token string\">'com.thoughtworks.xstream'</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'xstream'</span><span class=\"token punctuation\">,</span> version<span class=\"token punctuation\">:</span> <span class=\"token string\">'1.4.11.1'</span>\n implementation group<span class=\"token punctuation\">:</span> <span class=\"token string\">'org.springframework'</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'spring-oxm'</span><span class=\"token punctuation\">,</span> version<span class=\"token punctuation\">:</span> <span class=\"token string\">'5.1.10.RELEASE'</span>\n <span class=\"token punctuation\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Spring Boot의 따로 oxm은 없고 Spring 버젼에 맞는 oxm을 가져와서 추가해야 깔끔할겁니다<br>\n저는 Spring Boot 2.1.9를 사용하고 있고 해당 버젼의 spring-core는 5.1.10으로 oxm도 5.1.10으로 추가해 줬습니다<br>\nSpring Boot의 Spring 버젼 확인 방법은 아래와 같은 Compile Dependencies를 확인하시면 됩니다  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.357723577235774%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABhElEQVQoz2VS227bMAz1/3/F/mHPexjQPW4L0KZbFgwD2rWNY9e6Xy35lGLitEVlHJCiqEPyWJ2QEw7DiG/bR1zd3OOxP+I4jhzTWsJaDecDQkzwIbJNOSPnGS5GjM6x32INHWgNxuLT1y0+fz+glx6jDrgbPZyzGMcB0zQxBMERwbrqsiDVAiyXELqUK9Kc6dCfQ6+ntVYsdKmhnu1brOmr32xXyQ8h4Nf1b+x+3EAqBWMtNHVtrYMQguG95+4Y5BuyUmuSIcAYAykF83Q4s//bPWHzZQPlPJ5p7EkRQaDOaaRSCnd7wTwj7PYQ2z+oKZJ2hcg953WndhcIk3D7tyfNnhFSgY+Z7ExJ9cOo7UvawgwCCxXIc4G2iYt16/yDzvi579EfBxifaaQIZSO0S++1PPtxrpAus88dmnjqsJE1XR4e/qPvD/RUNCI9h6ZH080YzbbtV7S9JZ3X/aptu8eEpcy4uz9gt9mzwEIZSjj9BCkl25UohFNcSHUppJSG0oYJXwAmprfqLalFEwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Compile Dependencies\"\n        title=\"Compile Dependencies\"\n        src=\"/static/9941af1a7c7e4b6cb41c82b41b745819/36727/spring-version.png\"\n        srcset=\"/static/9941af1a7c7e4b6cb41c82b41b745819/acf4b/spring-version.png 173w,\n/static/9941af1a7c7e4b6cb41c82b41b745819/fc834/spring-version.png 345w,\n/static/9941af1a7c7e4b6cb41c82b41b745819/36727/spring-version.png 690w,\n/static/9941af1a7c7e4b6cb41c82b41b745819/17fa4/spring-version.png 1035w,\n/static/9941af1a7c7e4b6cb41c82b41b745819/a5044/spring-version.png 1380w,\n/static/9941af1a7c7e4b6cb41c82b41b745819/5c8bc/spring-version.png 1476w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<br/>\n<p>자 그럼 이제 필요한 요건은 모두 갖춰졌습니다<br>\n이제 XML을 VO로 읽어 보겠습니다<br>\nSpring Batch에서는 XML을 읽기 위해서 <code class=\"language-text\">StaxEventItemReader</code> Class를 제공합니다  </p>\n<br/>\n<p><strong>먼저 VO객체 Class를 정의합니다</strong>  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">XmlItemVo</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> number<span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">String</span> data<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>주의 하실점은 다른곳에서도 사용하는 VO로 생성자를 재정의 할 경우 Default 생성자는 꼭 생성을 해주셔야 합니다  </p>\n<br/>\n<p><strong>다음으로 ItemReader Bean을 정의합니다</strong>  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Bean</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">StaxEventItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">XmlItemVo</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">xmlFileItemReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StaxEventItemReaderBuilder</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">XmlItemVo</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"xmlFileItemReader\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">resource</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ClassPathResource</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sample_xml_data.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">addFragmentRootElements</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"item\"</span><span class=\"token punctuation\">)</span>\n<span class=\"gatsby-highlight-code-line\">            <span class=\"token punctuation\">.</span><span class=\"token function\">unmarshaller</span><span class=\"token punctuation\">(</span><span class=\"token function\">itemMarshaller</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span>            <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위의 소스를 한눈의 알아 볼 수 있을 정도로 간결합니다<br>\n그중에서 기존에 spring-oxm을 안접해 보신 분들에게는 <code class=\"language-text\">unmarshaller</code>만 새로운 개념으로 보이실 겁니다<br>\nunmarshaller는 간단히 말해서 스트림을 객체로 역직렬화하는 것입니다<br>\n관련 정보의 대해 자세히 알고 싶으신 분들은 <a href=\"https://blog.outsider.ne.kr/891\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Outsider’s Dev Story</a>해당 포스터를 참고해 주시기 바랍니다  </p>\n<br/>\n<p><strong>itemMarshaller는 역질렬화는 XStreamMarshaller를 통해 간단하게 정의 가능합니다</strong>  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Bean</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">XStreamMarshaller</span> <span class=\"token function\">itemMarshaller</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Class</span><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> aliases <span class=\"token operator\">=</span> <span class=\"token class-name\">Maps</span><span class=\"token punctuation\">.</span><span class=\"token function\">newHashMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    aliases<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"item\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">XmlItemVo</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    aliases<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"number\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    aliases<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">XStreamMarshaller</span> xStreamMarshaller <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XStreamMarshaller</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    xStreamMarshaller<span class=\"token punctuation\">.</span><span class=\"token function\">setAliases</span><span class=\"token punctuation\">(</span>aliases<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> xStreamMarshaller<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>각 필드별 자료형을 정의해 주고 setAliases로 넘겨주기만 하면 간단하게 마샬링이 구현가능합니다<br>\n다음과 같은 구현으로 XML Reader는 구현이 끝났습니다  </p>\n<p>하지만 그냥 실행하게 된다면 다음과 같은 경고를 만나실 수 있습니다  </p>\n<br/>\n<p><span class='red_font'>Security framework of XStream not initialized, XStream is probably vulnerable</span></p>\n<br/>\n<p>해당경고는 XStream이 보안허점이 될수 있으므로 언마샬링 대상을 지정하여 설정하기를 권장하기 때문입니다<br>\n다음과 같이 보안 설정 파일을 만들어서 해결 가능합니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JobSecurityConfig</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">JobSecurityConfig</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">XStreamMarshaller</span> marshaller<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">XStream</span> xstream <span class=\"token operator\">=</span> marshaller<span class=\"token punctuation\">.</span><span class=\"token function\">getXStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token class-name\">XStream</span><span class=\"token punctuation\">.</span><span class=\"token function\">setupDefaultSecurity</span><span class=\"token punctuation\">(</span>xstream<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>        xstream<span class=\"token punctuation\">.</span><span class=\"token function\">allowTypes</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Class</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">{</span><span class=\"token class-name\">XmlItemVo</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<hr>\n<p><strong>4. JSON 파일 ItemReader</strong> 👉 <a href=\"https://github.com/renuevo/spring-boot-in-action/blob/master/spring-boot-batch-in-action/src/main/java/com/github/renuevo/config/JsonFileItemReaderJobConfig.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Code</a><br>\n이번엔 XML 형식보다 요즘 많이 사용되는 JSON형식을 읽는 ItemReader에 대해 알아 보겠습니다<br>\nJson형식은 XML처럼 복잡하지 않고 간단하게 Spring Batch에 있는 <code class=\"language-text\">JsonItemReaderBuilder</code>로 ItemReader를 생성 가능합니다  </p>\n<br/>\n<p><strong>먼저 Sample Json 파일을 준비합니다</strong>  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"number\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"data\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"one\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"number\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"data\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"two\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"number\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"data\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"three\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"number\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"data\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"four\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<br/>\n<p>**그리고 그것에 맞는 VO Class를 하나 생성해 줍니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token annotation punctuation\">@NoArgsConstructor</span>\n<span class=\"token annotation punctuation\">@AllArgsConstructor</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JsonItemVo</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> number<span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">String</span> data<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>만약 VO객체의 변수명과 Json객체의 명이 다를 경우는 <code class=\"language-text\">@JsonProperty</code>를 사용해 이름을 지정해 주시면 됩니다<br>\n<code class=\"language-text\">JacksonJsonObjectReader</code>를 사용해서 내부적으로 ObjectMapper로 구현되기 때문입니다<br>\nJackson과 관련하여 자세한 사용법을 알고 싶으시면 👉 <a href=\"https://www.baeldung.com/jackson\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Jackson JSON Tutorial</a>  </p>\n<br/>\n<p><span class='code_header'>JsonItemReader</span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Bean</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">JsonItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">JsonItemVo</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">jsonItemReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JsonItemReaderBuilder</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">JsonItemVo</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"gatsby-highlight-code-line\">            <span class=\"token punctuation\">.</span><span class=\"token function\">jsonObjectReader</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">JacksonJsonObjectReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonItemVo</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span>            <span class=\"token punctuation\">.</span><span class=\"token function\">resource</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ClassPathResource</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sample_json_data.json\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jsonItemReader\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ItemReader 설정은 다음과 같이 간단한 설정으로 JsonItem은 Read 가능합니다<br>\n<strong>JsonItemReaderBuilder로 build하면서 jsonObjectReader로 JacksonJsonObjectReader로 설정하고 VO객체를 적용해 주면 됩니다</strong><br>\n그리고 실행하시면 아래 처럼 잘 Read 되는걸 확인 할 수 있습니다  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.17971758664955%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABSklEQVQoz21S7XKDIBD0cQrGjCLKl2CoSd//jbZ72GTSTn/crMC5t7vQxdyjbB7r7DFcByilsKUEEzyUtdD81qVA7/uJ3qPXGjvXx3Hgfj+Q2FM/K9Z1QZeKRnAL5sliGIRQw60rxmWBMgaaqLnWzp3oHfrrFTEEOO4FohB6DrIU0KX9JLRmfREGHo5sVkLyXkIYA/p5Rt62RrQRpWKMDbv6RcuJ02x4WZZmkyI+GkGEzpl284msyzThs1ZU1u12a5h5XvaCbj96bMExQ/ejUDU7E1WqxbbMGmmKZ57Eyzi2oTmXpipziNg3jKiTS/EM04x/MuSeeuYnKCW2eVk9f0wcIrlJhmJ3ZgyWArpcqTA6LG8KpXliY8swPpWxqEZQLFdaFXViectUWU61VHjBnn9nKAdGCOXZCMl/z4ZEx3HH4/Fo/fJsEuP4BmhYBM9lDUapAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Json Reader\"\n        title=\"Json Reader\"\n        src=\"/static/66dbac17552f4ae1eb38ced96b4c2e22/36727/json-reader.png\"\n        srcset=\"/static/66dbac17552f4ae1eb38ced96b4c2e22/acf4b/json-reader.png 173w,\n/static/66dbac17552f4ae1eb38ced96b4c2e22/fc834/json-reader.png 345w,\n/static/66dbac17552f4ae1eb38ced96b4c2e22/36727/json-reader.png 690w,\n/static/66dbac17552f4ae1eb38ced96b4c2e22/16fa1/json-reader.png 779w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<br/>\n<hr>\n<p><strong>5. Multi 파일 ItemReader</strong> 👉 <a href=\"https://github.com/renuevo/spring-boot-in-action/blob/master/spring-boot-batch-in-action/src/main/java/com/github/renuevo/config/MultiFileItemReaderJobConfig.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Code</a><br>\nFile Item Reader의 마지막으로 여러 File을 읽는 방법을 소개 하겠습니다<br>\n여러 파일을 읽을 때는 Spring Batch에서 제공하는 <code class=\"language-text\">MultiResourceItemReader</code>를 사용하시면 됩니다<br>\n일단 sample txt 파일 2개를 준비합니다  </p>\n<p><span class='code_header'>sample.txt</span></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">첫번째\n두번째\n세번째\n네번째\n다섯번째</code></pre></div>\n<p><span class='code_header'>sample2.txt</span></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">여섯번째\n일곱번째\n여덟번째\n아홉번째\n열번째</code></pre></div>\n<p>Sample txt를 한 폴더에 두는 것으로 데이터는 준비되었습니다  </p>\n<br/>\n<p><span class='code_header'>Multi File ItemReader</span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Bean</span>\n<span class=\"token annotation punctuation\">@SneakyThrows</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">MultiResourceItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ItemVo</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">multiResourceItemReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">MultiResourceItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ItemVo</span><span class=\"token punctuation\">></span></span> resourceItemReader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MultiResourceItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ItemVo</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    resourceItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setResources</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ResourcePatternUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">getResourcePatternResolver</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>resourceLoader<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getResources</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"read_sample/*.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span><span class=\"gatsby-highlight-code-line\">    resourceItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setDelegate</span><span class=\"token punctuation\">(</span><span class=\"token function\">multiFileItemReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span>    <span class=\"token keyword\">return</span> resourceItemReader<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token annotation punctuation\">@Bean</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ItemVo</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">multiFileItemReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ItemVo</span><span class=\"token punctuation\">></span></span> flatFileItemReader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FlatFileItemReader</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    flatFileItemReader<span class=\"token punctuation\">.</span><span class=\"token function\">setLineMapper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">,</span> lineNumber<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ItemVo</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> flatFileItemReader<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>다음은 <code class=\"language-text\">MultiResourceItemReader</code> 코드를 보겠습니다<br>\n이전에는 <code class=\"language-text\">FlatFileItemReader</code>에서 Resource를 설정해 줬지만 이번에는 Multi Reader에서는 <code class=\"language-text\">MultiResourceItemReader</code>에 Resource를 Array를 설정해 주는것 만으로\n여러 파일들을 읽게 설정이 가능합니다  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.44834930777423%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABkUlEQVQoz3WTWZqDIBCEvQ6oSVzYBJd4/zv1VIEmmYzz0B+xlZ+qLlL5qRFvJrnfblLXtXjvpR1H0daKDkF0TKgoquvEoL8sizyfT4nsKfWnqnkFcAy/gYSxnBONZ4KVMWLQSyllGGuaJjHoD8NQCgdW80YgFN7vbyBAytkC84BiI58t+vM8Z+gJTjN+o+fwzhgr1bo3Ekx8A6EmK6RtgHREYbPCs0WfllOKGcjDA77v+15ucNh1/RewafIHLT5UUyhAzhEKVPDi0F/XtUChzEE9DxlxGMVoraVKmOFk3wozEPZUDiSWIhCz8gdw3/cMHQ/VnGOH0B6Ph1RxgSr7pRAfKQZCKKy9LGMjgdu25VkS0LZtFsK1he2vGR5Aphr8kbAv18bTcpAVygibsZZ5loC4j8Fcp3yGEo45EngRSsA7rgQxmHE0n8CLe0jgMUtlTZ4V1cVU7iDvXj+UhBmI1vU/QN5Df1jmLLNll1POFpFwxEoorbLokOAqxIu/HpS8QjktQ82pkCkbKCbkVQiIon4A92+D3mxvJoMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Multi File Reader\"\n        title=\"Multi File Reader\"\n        src=\"/static/595ec3f4bb2ef59ccc5dfeed57703679/36727/multi-file-reader.png\"\n        srcset=\"/static/595ec3f4bb2ef59ccc5dfeed57703679/acf4b/multi-file-reader.png 173w,\n/static/595ec3f4bb2ef59ccc5dfeed57703679/fc834/multi-file-reader.png 345w,\n/static/595ec3f4bb2ef59ccc5dfeed57703679/36727/multi-file-reader.png 690w,\n/static/595ec3f4bb2ef59ccc5dfeed57703679/10016/multi-file-reader.png 939w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n    </span>  </p>\n<br/>\n<p>참고로 Resource를 Array를 읽는 방법은 여러가지가 있습니다<br>\n저는 위에 처럼 getResourcePatternResolver를 사용해 Pattern으로 가져와서 MultiResourceItemReader에 설정 해 줬습니다<br>\n다음과 같이도 설정이 가능합니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"input/sample*.csv\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">private</span> <span class=\"token class-name\">Resource</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> inputResources<span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<hr>\n<p>이것으로 File ItemReader에 대해서 알아 봤습니다<br>\n위와 같이 Spring Batch는 여러 종류의 File들을 간편하게 Read 하는 방법을 제공 하고 있습니다<br>\n다음으로는 보다 안정적으로 데이터 관리하고 사용하는 DB와 Spring Batch를 연동하여 Read하는 방법에 대해서 알아보도록 하겠습니다  </p>\n<hr>\n<h2 id=\"관련-참고\"><a href=\"#%EA%B4%80%EB%A0%A8-%EC%B0%B8%EA%B3%A0\" aria-label=\"관련 참고 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>관련 참고</h2>\n<p><a href=\"https://docs.spring.io/spring-batch/docs/current/reference/html/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Batch Doc</a><br>\n<a href=\"https://jojoldu.tistory.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">기억보단 기록을</a>   </p>","frontmatter":{"title":"[Spring] 2. Spring Batch의 ItemReader - File Item Reader","date":"March 05, 2020"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/spring/batch/spring-batch-chapter-2/","previous":{"fields":{"slug":"/spring/batch/spring-batch-chapter-1/"},"frontmatter":{"title":"[Spring] 1. Spring Batch의 기본 개념","category":"Spring"}},"next":{"fields":{"slug":"/docker/docker-setup/"},"frontmatter":{"title":"[Docker] Windows10 Docker 설치","category":"Docker"}}}}}