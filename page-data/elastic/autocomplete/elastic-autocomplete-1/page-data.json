{"componentChunkName":"component---src-templates-blog-post-js","path":"/elastic/autocomplete/elastic-autocomplete-1/","webpackCompilationHash":"eda9a9271bf97b59714d","result":{"data":{"site":{"siteMetadata":{"title":"renuevo blog","author":"deokhwa kim","siteUrl":"https://renuevo.github.io","comment":{"disqusShortName":"https-renuevo-github-io","utterances":""},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"9cb80131-bce1-5077-aa0d-f2a285020a74","excerpt":"Elastic을 활용하여 다음 3가지 방법의 자동완성 서비스를 구현하는 기술을 다룹니다 Elastic 7.x 버젼을 기준으로 진행합니다    Prefix Queries를 활용한 자동완성   Index 색인을 통한 Search   Completion Suggester를 활용한 자동완성   해당 포스팅에서는 를 활용한 가장 단순한 자동완성을 만드는 방법 소개합니다   Example Data Setting 먼저 테스트 데이터를 준비해 줍니다 간단한 Index Mapping…","html":"<p><em>Elastic을 활용하여 다음 3가지 방법의 자동완성 서비스를 구현하는 기술을 다룹니다</em><br>\n<em>Elastic 7.x 버젼을 기준으로 진행합니다</em>   </p>\n<ol>\n<li>Prefix Queries를 활용한 자동완성  </li>\n<li>Index 색인을 통한 Search  </li>\n<li>Completion Suggester를 활용한 자동완성  </li>\n</ol>\n<p>해당 포스팅에서는 <code class=\"language-text\">Prefix Queries</code>를 활용한 가장 단순한 자동완성을 만드는 방법 소개합니다  </p>\n<br/>\n<hr>\n<h2 id=\"example-data-setting\"><a href=\"#example-data-setting\" aria-label=\"example data setting permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example Data Setting</h2>\n<p>먼저 테스트 데이터를 준비해 줍니다<br>\n간단한 Index Mapping 정보를 작성합니다  </p>\n<p><span class=\"code_header\"><strong>Autocomplete Example Mapping</strong></span>  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">PUT autocomplete_test_<span class=\"token number\">1</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"settings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"number_of_shards\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"number_of_replicas\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"_doc\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"fields\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"keyword\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keyword\"</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>word에 2가지 속성으로 색인을 하였습니다  </p>\n<ol>\n<li>\n<p><code class=\"language-text\">text</code> type은 형태소 분석를 통해서 색인 키를 가지게 됩니다<br>\n따로 설정이 없으면 Standard Analyzer로 색인되는데 기본적으로 <code class=\"language-text\">불용어, lowercase, whitespace</code>로 색인 됩니다<br>\n<strong>스팀게임 추천 :</strong> <code class=\"language-text\">스팀게임</code> <code class=\"language-text\">추천</code>  두개의 단어로 키가 잡힙니다\n호출로 색인 키를 확인 할 수 있습니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">   GET autocomplete_test_<span class=\"token number\">1</span>/_analyze\n   <span class=\"token punctuation\">{</span>\n     <span class=\"token property\">\"text\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"스팀게임 추천\"</span>\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 448px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.35714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAABzUlEQVQ4y6WT2W7bMBRE/f8flae+NSjgJohdp14UW5G1kRRFipQlezokGgMF4iWogAGh7XDuvcPJ8XiC9z1U00Jbj4bStod1h0/V3dDkdDrBdh1a45BWDX6lFQplodsOUls4P3LDMa4BaLr+qiLQOc8bD9kY1NS21oSauONeCazKFOsqhTL2DL1UwSSUHIDW9RCNRUX9WO+x3Ass3gWedzm2VYFFlkbHdwG9/wukqwB83pZ4zQTmaYmkqLAtK+SyjY4/SrsIDCWHoQSgJCyU+n2V0aFEViu6TPC0S7CXEq319zk07E3ooVAtaqrSDiUHI7g6d6SzYxyM6a7DInAcR0jVxA9rllURKDnxxnhCBpRacQMNE364MeE45QBsNPvjD7Hk0MNpUmBTKOyFwU+Wuyre6ba76uzssD8MDLU+O8ylwXSTY7ar8MhernPNNljCNRSz2cbg+7h+pknOMK+SDGmusCHkN/XwtMF0mWHO54+vM3ybv2D2luJlkWDH765pMgxD7OE5Nuzhki8SlhzcCmZPtF18Hxzc1UNFYGtdnLDhT47D+Dib9ouKDoVUUNpwsu6u83rDIXPWMW/+31NwK2+Xg82TEi7fD/8NC/oD8yHOtCiK9bIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"analyzer-test\"\n        title=\"analyzer-test\"\n        src=\"/static/4cc296054549f55d9120ec605c1456e3/6e872/analyzer-test.png\"\n        srcset=\"/static/4cc296054549f55d9120ec605c1456e3/acf4b/analyzer-test.png 173w,\n/static/4cc296054549f55d9120ec605c1456e3/fc834/analyzer-test.png 345w,\n/static/4cc296054549f55d9120ec605c1456e3/6e872/analyzer-test.png 448w\"\n        sizes=\"(max-width: 448px) 100vw, 448px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Standard Analyzer</span>  </p>\n <br/>\n</li>\n<li><code class=\"language-text\">keyword</code> type은 텍스트 자체를 키로 색인을 합니다<br>\n<strong>스팀게임 추천 :</strong> <code class=\"language-text\">스팀게임 추천</code>이라는 문장으로 키가 잡힙니다</li>\n</ol>\n<h2 id=\"br\"><a href=\"#br\" aria-label=\"br permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><br/></h2>\n<p>이제 기본 개념을 알아봤으니 예제의 사용할 데이터를 생성하겠습니다<br>\n<span class=\"code_header\"><strong>Autocomplete Example Data</strong></span>  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">POST _bulk\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"autocomplete_test_1\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"스팀게임\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"autocomplete_test_1\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"2\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"스팀게임 추천\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"autocomplete_test_1\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"3\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"스팀게임 추천 2019\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"autocomplete_test_1\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"4\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"스팀게임 환불\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"autocomplete_test_1\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"5\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"스팀게임 싸게\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"autocomplete_test_1\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"6\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"스팀게임 순위\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"autocomplete_test_1\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"7\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"스팀게임 추천 2020\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"autocomplete_test_1\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"8\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"스팀게임 환불하는법\"</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>자동완성 데이터는 Google에 스팀게임을 검색해서 나오는 자동완성을 가져왔습니다  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 660px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.54545454545455%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABAklEQVQoz5WS23KDIBRF+f+/65jO1JE2TbxAFTmIqAk3ezTtJE/GrDmvi33YQKDrx2kMIc4PDMP4kX1/narjmW0M8c7FEMZpGgbj7EV1+lhCjNEvBOf8xhB7nSbTuYso8hOln0lyeEveKaVpmmYZPW9CQsTgEIPXWksJjPG8KIui1LpXuMYmi4yXxD2dc3gKLq/7BWvt/Axyqwrlq11QSrWt5JyDgh1yvMvYAWaKVtZNM++A+DUZj8BY7LfvjVp5Qf5b2znUBO4NsEt+vDN2pjsNAEIIkPCCvAa7bpUrxtCPMe6SEWNMI8RPXTPOz3leVlUr8eFhY+7y7UsuH+a/f/+MX1kG77SixCc4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"google-search\"\n        title=\"google-search\"\n        src=\"/static/adb13c086f0589274d824a31187fa134/2a182/google-search.png\"\n        srcset=\"/static/adb13c086f0589274d824a31187fa134/acf4b/google-search.png 173w,\n/static/adb13c086f0589274d824a31187fa134/fc834/google-search.png 345w,\n/static/adb13c086f0589274d824a31187fa134/2a182/google-search.png 660w\"\n        sizes=\"(max-width: 660px) 100vw, 660px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Google Search</span>  </p>\n<br/>\n<br/>\n<p>만약 7.X보다 밑의 버젼을 쓰신다면 type을 추가해주셔야합니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">POST _bulk\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_index\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"autocomplete_test_1\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"_type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"_doc\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"스팀게임\"</span><span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<br/>\n<h2 id=\"prefix-query\"><a href=\"#prefix-query\" aria-label=\"prefix query permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Prefix Query</h2>\n<p>먼저 Prefix Query를 살펴보겠습니다<br>\n<code class=\"language-text\">Prefix Query</code>는 Elastic에서 제공하는 앞글자 일치 검색기능 입니다<br>\n간단한 쿼리를 통해서 <code class=\"language-text\">text</code>와<code class=\"language-text\">keyword</code> type들에 대해 어떻게 검색이 다르게 되는지 살펴 보겠습니다  </p>\n<br/>\n<p><strong><em>여기서 부터 차례로 text와 keyword을 번갈아 가면서 어떻게 다르게 검색되는지 살펴보겠습니다</em></strong>  </p>\n<p>형태소 분석이된 <code class=\"language-text\">Text Type</code>에 대한 검색입니다<br>\n띄어쓰기 기준으로 키워드가 색인된 것을 앞서 확인했습니다<br>\n예를 들어 <code class=\"language-text\">스팀게임 추천</code>이라는 문장은 <code class=\"language-text\">스팀게임</code>과 <code class=\"language-text\">추천</code> 이라는 2개의 키워드를 통해 검색됩니다  </p>\n<br/>\n<p>Prefix쿼리로 먼저 앞글자 단어 일치를 확인해보겠습니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"prefix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스팀게\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 612px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.0392156862745%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAB5UlEQVQ4y52UW4/aMBSE9///sn3Zh2pVipZbIeSC49iOHSfhpunYwIp2gZJ9GGHJPsOcfPZ5KXIJq2o4yhsHry289fDdDr7dnhTWd9Sc953vMRrP8ZK9vmE5nkFN5rCLFdp1jnY8iaZNvx9uaGj0UWgssgqSKYVl2uk8pg2GoeBS1Nww/2KYvv1AMpog/fkBPV1AhHRM6nngVuG/pl8Mk8ohVQ20a2G56Tqm2h7gzskGJzSmgaw9FhsNxe+2lgWWIkMiBTJdIaeUaz6L/5tQ0yytLGa5oqGlYYm66eLBcMi1/cOUNw0z5fC+EkhlTWlI62B9d7e9h4aKLas6tGqZsIWoNSYiwcZotJeCdgCUklfFssX9/hg3+v6I/Q7ot0ca7qMGQam0i1B+C0PSHYkLLMscK7n5HhRjT+3+WkuUdU3aOf/AouY3rH0bNRhKTiijpCQQg0KdzOxZn4Xd9nkoFU0TEg5QNkZhVq6xrAq2LP+63E+1HKA4QtnuDpFq1x8ikCiuuzAg7gB5CGVJKIZQMlUSSHGCor75Ui5QhCEUkaPkr2naqJpy50HxtGGAMuXTy/kEA5Q4GK4gNINeCg0lwcw5HKTxKNjirEyxqjYRSlIJ0h6QUIZrwtF1fT2uB0JYnwqfS/gH8kX8VYPq8zkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"search-prefix-text\"\n        title=\"search-prefix-text\"\n        src=\"/static/86783b78d8a731062ae5c2c491c7049f/ad08f/search-prefix-text.png\"\n        srcset=\"/static/86783b78d8a731062ae5c2c491c7049f/acf4b/search-prefix-text.png 173w,\n/static/86783b78d8a731062ae5c2c491c7049f/fc834/search-prefix-text.png 345w,\n/static/86783b78d8a731062ae5c2c491c7049f/ad08f/search-prefix-text.png 612w\"\n        sizes=\"(max-width: 612px) 100vw, 612px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Prefix Text Search</span><br>\n정상적으로 모든 <code class=\"language-text\">스팀게임</code>의 키워드를 기준 앞글자가 일치하는 모든 결과가 검색된걸 확인할 수 있습니다  </p>\n<br/>\n<br/>\n<p>다음은 <code class=\"language-text\">Keyword Type</code>에대해 Prefix쿼리로 검색합니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"prefix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word.keyword\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스팀게\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 612px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.0392156862745%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAB5UlEQVQ4y52UW4/aMBSE9///sn3Zh2pVipZbIeSC49iOHSfhpunYwIp2gZJ9GGHJPsOcfPZ5KXIJq2o4yhsHry289fDdDr7dnhTWd9Sc953vMRrP8ZK9vmE5nkFN5rCLFdp1jnY8iaZNvx9uaGj0UWgssgqSKYVl2uk8pg2GoeBS1Nww/2KYvv1AMpog/fkBPV1AhHRM6nngVuG/pl8Mk8ohVQ20a2G56Tqm2h7gzskGJzSmgaw9FhsNxe+2lgWWIkMiBTJdIaeUaz6L/5tQ0yytLGa5oqGlYYm66eLBcMi1/cOUNw0z5fC+EkhlTWlI62B9d7e9h4aKLas6tGqZsIWoNSYiwcZotJeCdgCUklfFssX9/hg3+v6I/Q7ot0ca7qMGQam0i1B+C0PSHYkLLMscK7n5HhRjT+3+WkuUdU3aOf/AouY3rH0bNRhKTiijpCQQg0KdzOxZn4Xd9nkoFU0TEg5QNkZhVq6xrAq2LP+63E+1HKA4QtnuDpFq1x8ikCiuuzAg7gB5CGVJKIZQMlUSSHGCor75Ui5QhCEUkaPkr2naqJpy50HxtGGAMuXTy/kEA5Q4GK4gNINeCg0lwcw5HKTxKNjirEyxqjYRSlIJ0h6QUIZrwtF1fT2uB0JYnwqfS/gH8kX8VYPq8zkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"search-prefix-keyword\"\n        title=\"search-prefix-keyword\"\n        src=\"/static/86783b78d8a731062ae5c2c491c7049f/ad08f/search-prefix-keyword.png\"\n        srcset=\"/static/86783b78d8a731062ae5c2c491c7049f/acf4b/search-prefix-keyword.png 173w,\n/static/86783b78d8a731062ae5c2c491c7049f/fc834/search-prefix-keyword.png 345w,\n/static/86783b78d8a731062ae5c2c491c7049f/ad08f/search-prefix-keyword.png 612w\"\n        sizes=\"(max-width: 612px) 100vw, 612px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Prefix Keyword Search</span><br>\nText Type과 같이 모든 단어가 검색된걸 확인할 수 있습니다  </p>\n<p>둘의 검색을 비교해 보면 다음과 같습니다  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.252747252747252%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABcRAAAXEQHKJvM/AAABe0lEQVQY02MIDkxjFJ95hpkBCHgZGASBlDgfAwM/iD81p4N1d3Yt6/asOtZlyZUs/YnlzFtrZrGB5BgZGESAlGw0AwMriD8xKo99V0IxkL32JS9IgKHvkB1D/54W/Y03Sxn6dtcD+VoM6OD/f7DFDBOOuXNMPVijt/xMMUPnznygOBdcTbVXlIoGKyPP1Pjy7IW5TXcOTlx8em52w5UtwVmO/x1cQv4nZ5b8j00u/u8VGPI/OMbmv7df7ta4onXzy7pvb+qcfWVOafe5v1Gpdf+9/HP++4XkMwQZ2xnw8wrI1nrH5FcFJb+uTCh80B6ddb+ssGVBZ0rZ1cbEkpe1sYWfaoPT19aFZhbXhWV9qfNPutkRl3tvaknjwym51TeaI3Me14RkPq8NzXzOwOASJ8TAysHFkNatx5DckcwQWR/NUDUrzrZjfp5s55J4hoSWKIbYxkSG5DZXhsRWPYak1kSGhNZYhooZ8Vpdi5OF6mYlM6R1xgDFYoByMQBrjI7ABxl+NAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"elastic-search-index\"\n        title=\"elastic-search-index\"\n        src=\"/static/c009d0460c0bf063d7e2def06c54b256/36727/elastic-search-index.png\"\n        srcset=\"/static/c009d0460c0bf063d7e2def06c54b256/acf4b/elastic-search-index.png 173w,\n/static/c009d0460c0bf063d7e2def06c54b256/fc834/elastic-search-index.png 345w,\n/static/c009d0460c0bf063d7e2def06c54b256/36727/elastic-search-index.png 690w,\n/static/c009d0460c0bf063d7e2def06c54b256/17fa4/elastic-search-index.png 1035w,\n/static/c009d0460c0bf063d7e2def06c54b256/a5044/elastic-search-index.png 1380w,\n/static/c009d0460c0bf063d7e2def06c54b256/f9966/elastic-search-index.png 1820w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Elastic Index Search</span>  </p>\n<p>그래서 둘 모두 같은 결과를 내놓았습니다<br>\n만약 Text Type에 형태소에서 <code class=\"language-text\">스팀게임</code>이라는 단어를 <code class=\"language-text\">Index Key</code>로 잡지 않았다면 전혀 다른 결과가 나오게 됩니다  </p>\n<br/>\n<br/>\n<p>다음으로 <code class=\"language-text\">Text Type</code>에 <code class=\"language-text\">추천</code>으로 검색해 보겠습니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"prefix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"추천\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 625px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.88000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAB9klEQVQ4y5WUWW/bMBCE8///VIEiQAq06GuPuEEV67BE8RQP20kxnZVjJymKRHogJNnkcHe/nb0KsWDTGXQ6wIWEVI6XFfPh1fdb67z3KuY9lI340Wo0o4elqI3psmGp6EVwYoSjnXCvPLZjmAV31s0b/l1vXXARTHz51WlUg8foJripwMcDyv4BuTyv96J9jjDtoRmhDpkpB4oVdHZEqxUaPaJ3BoN3CKksizBQ0PrEdD3udhbKe1RqNz9NLrBcjjWVi5cJxpNgoyfcknZvA3ozMeVHFO2RTUDar0zZUHBg2j9JWohvdY+NqlFdf4D6+gXp8Lgciggq4yG0DzyY+eMMQaBoh8yL8toIpW1GRtkyVTtlto2eobQE0hPI4NZAYQ0dCQuUW6asQ8DvoeMFhJLyE5SMKe/XUa5pvW+1tItDRxBRNvYjkjKn93VQIpSLuOsttBC3Cptdhe3NRzSfb/itkfLxlWPeh8IaPRz/zFDmlpFF8cJyFMJa7RSBUtMpjrRbIy4ZUBuNnbN0i4VMpVVQKg6H783I1OmYvuUF4QQki7fz8j48Q5GWkRHW0R09I57rVbeIXY9JDp2nziIo7gRFRphhtJ3T9PU9mk/XaGco5nJoEZSR/pVnfvHnvIFNnp5qtxiK50D1cvA/EURaLr5Id0kN/wLyGARQrkcE/gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"search-prefix-text2\"\n        title=\"search-prefix-text2\"\n        src=\"/static/5423fa975b866c8462f7ee1ede430215/aa4a2/search-prefix-text2.png\"\n        srcset=\"/static/5423fa975b866c8462f7ee1ede430215/acf4b/search-prefix-text2.png 173w,\n/static/5423fa975b866c8462f7ee1ede430215/fc834/search-prefix-text2.png 345w,\n/static/5423fa975b866c8462f7ee1ede430215/aa4a2/search-prefix-text2.png 625w\"\n        sizes=\"(max-width: 625px) 100vw, 625px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Prefix Text2 Search</span><br>\n예상한것과 같이 추천이 뒤에 포함된 결과들이 검색된걸 확인할 수 있습니다  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.21693121693122%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB4klEQVQoz4WTu24TQRSG9wVoeAQeg4YeCVIADVK4RKJD9BSkoEBCyB2IR6ChiZCokKBAsZAMkQPhInyJncS39e7s7MU76718nN0Qi8I2Z3V0tpj5zn9m/rFm2qGnu9SjNvXwNx/877STMc5MM409gsKg8xidzZamSkPiNGHHa7A9eI3lT3p8HTbYCZq89fZ4433hwByjXIXn+aRJSmESKFiaWZ7DHF45u2x2X2KxIlylcAYDtNRca4qiWJ0V/TSsIJ8REKOI5Evk3xDKmMfjIXavj8isFlZbimJp8zNoqdbqDcd8a7U46LT50enw87DLxNfYysXrH4HvL2DrVJaRZhnWu/p7NrcesHHjHlc27nLx0mX2938Rxwan36eQcSvYfxSWMU8F2GztcfPWfe5s3eba9aucO3+BT40mYRjSEaB7ckJu2wvoWoUl8OPuZ7YfP+NF7Tm1pzUePnpCq3MkRydjC1DJpSTOVNona0dfAKNZjEnMX8l5VctxXbmMbDSCPGdl/ANbAP0gYmJP8YMQW6or/osiMbIf4toOnhKDB4pRZONGmvk8q87qrGZZgWs0rjyCOJ6fKizHMsYwnU4JgkAWppWpJ55CRyFhLA3iqKpGjF5mIsCyqeN6KHGC7TiU4v4ArtY73i9E9cUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"naver-recommend\"\n        title=\"naver-recommend\"\n        src=\"/static/a6c4c7abca1ed89696b5394fc390c3c1/36727/naver-recommend.png\"\n        srcset=\"/static/a6c4c7abca1ed89696b5394fc390c3c1/acf4b/naver-recommend.png 173w,\n/static/a6c4c7abca1ed89696b5394fc390c3c1/fc834/naver-recommend.png 345w,\n/static/a6c4c7abca1ed89696b5394fc390c3c1/36727/naver-recommend.png 690w,\n/static/a6c4c7abca1ed89696b5394fc390c3c1/50bbc/naver-recommend.png 756w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Naver Autocomplete</span><br>\n다음과 같이 뒤에 단어까지 확장된 검색이 필요하다면 Text Type의 색인된 검색결과를 입력하는게 효율적입니다  </p>\n<br/>\n<br/>\n<p>다음으로 <code class=\"language-text\">Keyword Type</code>에 <code class=\"language-text\">추천</code> 키워드로 검색해 보겠습니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"prefix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word.keyword\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"추천\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 427px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.00936768149883%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABGklEQVQoz6WR0W6CQBBF+f8PqzExLbGiqUUFgRItuAizi4Lt6UptapqmkvThZjMP9+65M0449VmNnyiXIYW/QgcRJozRX1qt0XtBDi3aHNF186ec3d2QZ89n7s7I/AA1X1Da0HqdUKevmHsXswyQE2h9uB2oxlNUC264xUsLUiXEu4q8MuSNpYrTjlra956ED4+o5o0wKwl3wjqvKOuWTIRI7zHRS1e7I+wTqGzleDCicCdsRy7K9dDjCflwRGnp68EQbev3JlSqwlskzIKUKNmSJBtUpsg2WSdtq4sNkrOhV+VCbMWGvWkw9pKlXXxljbVdgzmePq97CZMbYV1gKQfMZZArgo7qPF/e3oRivs3X+vlBXzn/Mf+mD+st/n0AMCHwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"search-prefix-keyword2\"\n        title=\"search-prefix-keyword2\"\n        src=\"/static/124f7b7122e57fc9095fea6badfc50d8/8928d/search-prefix-keyword2.png\"\n        srcset=\"/static/124f7b7122e57fc9095fea6badfc50d8/acf4b/search-prefix-keyword2.png 173w,\n/static/124f7b7122e57fc9095fea6badfc50d8/fc834/search-prefix-keyword2.png 345w,\n/static/124f7b7122e57fc9095fea6badfc50d8/8928d/search-prefix-keyword2.png 427w\"\n        sizes=\"(max-width: 427px) 100vw, 427px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Prefix Keyword2 Search</span><br>\n추천과 관련된 word가 3개가 있는데 검색 결과는 <span class='red_font'>0건</span>이 나왔습니다  </p>\n<br/>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.252747252747252%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABcRAAAXEQHKJvM/AAABhklEQVQY02MISKpjFC2awdST1sC8M6OadXvtBNYFiSVs////ZyhhYGBhYGAQARIS/xkYGP/f/894rmwCawADA/sCBgYBoJjoaQYGOSMg//+CYyyrwjLYGBi2fOES3fuHjQFoAAq485+LoWVzPt/C85WsM47WMbRuS4XLzbsvxtCxq0J12eV8zp5ddQxdB6zgco3uYUpiBrbC/zwC7P5Hxpf8r2nI+x8WXfDfyVdrYkzJ6nWVfZdWFXdcnZxQMe9/aKzlf5/AgpcBMa2Tcluvreucd35aed/NfTG5i//7BGT+9w0pYAgytjfgYeeQqQpILq+LKfhck133pCu57GVZUduSzri84w3h6U+qQlLf1PvELawPyyqpC8v6XBWY8qgjPvf+nLLmhxMyyh7UhaY/rAvNfF4LxAwMLrFCDBw8XAwpnboM8c2JDKFV0Qxl02JsO+blyXctSwKKRzMktiUxpHa6MyS26jEktSUyJLRGM1TMiFfvXJwsVD8nkSGjO5YhoSUGKBcDAIyOmYxhFbUhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"elastic-search-index2\"\n        title=\"elastic-search-index2\"\n        src=\"/static/17a51ebc717ffeb8bc102da4c48b93e0/36727/elastic-search-index2.png\"\n        srcset=\"/static/17a51ebc717ffeb8bc102da4c48b93e0/acf4b/elastic-search-index2.png 173w,\n/static/17a51ebc717ffeb8bc102da4c48b93e0/fc834/elastic-search-index2.png 345w,\n/static/17a51ebc717ffeb8bc102da4c48b93e0/36727/elastic-search-index2.png 690w,\n/static/17a51ebc717ffeb8bc102da4c48b93e0/17fa4/elastic-search-index2.png 1035w,\n/static/17a51ebc717ffeb8bc102da4c48b93e0/a5044/elastic-search-index2.png 1380w,\n/static/17a51ebc717ffeb8bc102da4c48b93e0/f9966/elastic-search-index2.png 1820w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Elastic Index Search2</span><br>\nType Type과 달리 들어오는 키워드 자체로 색인되기 때문에 추천이라는 글자가 포함되더라도 검색되지 않습니다  </p>\n<br/>\n<br/>\n<p><strong>그럼 무조건 Text Type의 검색일 사용하면 되는 걸까요?</strong><br>\nText Type으로 설정시 <span class='red_font'>치명적인 단점</span>을 가지고 있습니다<br>\n다음과 같이 각각의 키워드는 있으나 결합된 키워드로 검색시 결과가 나오지 않을 수 있습니다   </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"prefix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스팀게임 추\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 448px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.78571428571428%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAA1klEQVQoz52RyY4CMQxE+/+/jgPigthBCZ2JO4mzAYfCQWjUF0YTDlYi2S49Vw2eM+zE0C5CUQSnChcLYr4hlfvv+98agixvlcXBeLiQ4HxCfjebWK+wCFaQiKxOBmtF8o8wFMD5jlIf3ZSD5wIWSi0ii/0VGz3hbByMC7jQjwjXfkJDHkZ8tCFDTeKjLHtOGJ2Toc6TWwjaBiyPI/bi405bWM8YzQR1tYivwVsPYQFJwhdiUCgIQtbCibNgughbCG24SgB53vwi4ZfgfOlTdRF+c9Zf9QS8EQXJKSQrGAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"search-prefix-text3\"\n        title=\"search-prefix-text3\"\n        src=\"/static/867001024aabe2448998c7c9263cf186/6e872/search-prefix-text3.png\"\n        srcset=\"/static/867001024aabe2448998c7c9263cf186/acf4b/search-prefix-text3.png 173w,\n/static/867001024aabe2448998c7c9263cf186/fc834/search-prefix-text3.png 345w,\n/static/867001024aabe2448998c7c9263cf186/6e872/search-prefix-text3.png 448w\"\n        sizes=\"(max-width: 448px) 100vw, 448px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Prefix Text3 Search</span>    </p>\n<p>자동완성처럼 한글자씩 치면서 아래 계속해서 list를 펼쳐줘야 하는데<br>\n이는 치명적인 단점으로 다가오게 됩니다  </p>\n<br/>\n<br/>\n<p>반면 Keyword Type의 경우 색인된 결과와 앞글자를 일치 시켜주면 검색이 됩니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"prefix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word.keyword\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스팀게임 추\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 623px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.19743178170144%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAABu0lEQVQ4y5WU63KbMBCF8/7vl04yaZy2gLlJ6IqAOO7pkWpIybSN+LGzjEc6Prvfru6sn/BcD6iEgTYj/PSKMF0wMvuwpJwT69k7H2YMFHo4SxS9huS3cn47kCu6CbpxglAOlbQMB+0CWqXTgY/xvz/YBEd+nJoBL51GT2HDFmi3YJovqfQ1PnP7h0OWrD2kDSyZfXQT6qFHKTs67tGoAZ3WiL3OchgFtR1RCotTq9Brg0K0EMZC+3GLeC5fkCDqweGJtDtl0fDbh/fD4cOlz0umYM+yHysJwVyy5K9diW+iRqvV7kKWQzFYOPZoWd5+O9qAvLs75FCSrqDLgn1UHJtzgtIzCzR0GF0ehBLSHD5zfCKMH33LAaf4DYjxAS5kQrE3ynGov5R0NBjUFI8CuUP99zlkyadGpVyx5KeuwHfZoOA8xvLXS4egXF6v6cd5uRLQT8zzNcU0vx3Z5T2UuCkRyuqs5qZEMLGPh6AUfL4eKpE25aWrd5ti+IAcmkNFd2dux31BR9IQjE0ilmAinG3tcgVXKOWt5FpLnPoKxdAlQMehcH9jDvP+0PpsHdoU49gjF3YO/hU5PfwF7NQGx5wdHHUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"search-prefix-keyword3\"\n        title=\"search-prefix-keyword3\"\n        src=\"/static/b8fd34642ace5bc20a8e873dad1582ac/54ef9/search-prefix-keyword3.png\"\n        srcset=\"/static/b8fd34642ace5bc20a8e873dad1582ac/acf4b/search-prefix-keyword3.png 173w,\n/static/b8fd34642ace5bc20a8e873dad1582ac/fc834/search-prefix-keyword3.png 345w,\n/static/b8fd34642ace5bc20a8e873dad1582ac/54ef9/search-prefix-keyword3.png 623w\"\n        sizes=\"(max-width: 623px) 100vw, 623px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Prefix Keyword3 Search</span>    </p>\n<p>이 때문에 높은 <code class=\"language-text\">recall(재현율)</code>을 위해서 두가지 타입을 <code class=\"language-text\">OR</code>로 사용해서 서비스 할 수도 있습니다  </p>\n<br/>\n<p>하지만 아직 위의 구현으로는 쓸만한 자동완성을 만들 수 있지만 잘 만든 자동완성은 아닙니다<br>\n다음으로 <code class=\"language-text\">오타교정 자동완성</code>과 <code class=\"language-text\">형태소 분석</code>을 통한 자동완성을 살펴 보겠습니다   </p>\n<br/>\n<hr>\n<br/>\n<h2 id=\"fuzzy-query\"><a href=\"#fuzzy-query\" aria-label=\"fuzzy query permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fuzzy Query</h2>\n<p>다음으로 알아볼것은 Elastic에서 제공하는 <strong>Fuzzy Query</strong>를 통한 자동완성입니다<br>\nFuzzy Query를 사용하게 되면 <code class=\"language-text\">편집거리 알고리즘</code>을 사용하여 오타를 교정하는 검색이 가능해 집니다<br>\n간단히 설명드리면 <strong>fuzziness</strong>설정 값 이하로 <strong>글자를 바꾸거나, 넣거나, 빼는 횟수</strong>를 측정하여 검색합니다<br>\n<strong>편집거리 알고리즘(Levenshtein distance)</strong>에 대한 자세한 설명은 제 다른 포스팅을 확인해 주세요 👉 <a href=\"https://github.com/renuevo/data-modeling-algorithm/tree/master/levenshtein-distance\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">편집거리 알고리즘</a>   </p>\n<br/>\n<p>Fuzzy Query에 경우에도 아까 설명드린 <code class=\"language-text\">Text</code>와 <code class=\"language-text\">Keyword</code>에 대한 검색방식은 같습니다  </p>\n<p><strong>Text Type Fuzzy Query</strong><br>\n먼저 Text Type에 대해 검색을 하는 쿼리를 실행해 보겠습니다   </p>\n<p><span class='code_header'>Fuzzy Query Text Type Search</span>  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">## 바꾸거나\nGET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"fuzzy\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스게팀임\"</span><span class=\"token punctuation\">,</span>  </span>        <span class=\"token property\">\"fuzziness\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\nGET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"fuzzy\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스팀께임\"</span><span class=\"token punctuation\">,</span>  </span>        <span class=\"token property\">\"fuzziness\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n\n## 넣거나\nGET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"fuzzy\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스게임\"</span><span class=\"token punctuation\">,</span>  </span>        <span class=\"token property\">\"fuzziness\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n## 빼거나\nGET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"fuzzy\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스!팀게임\"</span><span class=\"token punctuation\">,</span>  </span>        <span class=\"token property\">\"fuzziness\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">fuzziness</code>를 <strong>1</strong>로 설정해서 1글자의 대해서 교정을 해주었습니다<br>\n그래서 <strong>한글자를 바꾸거나, 넣거나, 빼는</strong> 경우에 대해서 아래와 같이 모두 같은 결과가 나옵니다  </p>\n<br/>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 609px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.40229885057472%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAByUlEQVQ4y52U627iMBBGef8X3Iq2VFBy9TW+JKGs9O03pi1FQmzSH0McYZ3M+IxnE/OMbW2w7xycj0jTB8bpjDSeSmS+/1zfi6//hLVJ/DFDvkB7D+0TbIzccCL44yHoJ3Ccz1B2wCakCdpFtC6hsQkujqitQ+9lPX1n9yhbeZ++gJkvu8Zg13kogj0hyk+EZ9gwlY1yBPlBtjdAqVsylLIPyhdgbRWjx9EoNM6g9Q4+jcsyDAS6kHHUAS+NhR4G7FXHLEMpf0iXiOO8AsjsahvxxrI7FwgfygdaG+/a/G/JAlSU8qfS5VlbjW13gBr8t+nFUgQoi8Cy5tP5uumzbUTIailGpISxlClSGmYoYiqjKcSi876c46ozFNhr6yglUErLPvRscPZiyiVk3zJgukp5pmWR8q4GHHRExfhVyZbAnmU/VYbPxP7ri5SdqksfXjNbKEXbALmC8+nvp4jbDNbfFAINm1vus0jpeTMaa3gMppxlP6yRwjP0YtgEbFmyCWzwvuZZurKWyeMoJ+aVN6Ui8ImNXRuHA8fYXoVi/ndSOKoUQywrTzh78FVVeOmPeDfdzcBdJoWGRcplVF02yDAIeXo4FO4B/wHC1LXcASpOdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"search-fuzzy-text\"\n        title=\"search-fuzzy-text\"\n        src=\"/static/d6163360a94cad4d522a5a194188d280/672f7/search-fuzzy-text.png\"\n        srcset=\"/static/d6163360a94cad4d522a5a194188d280/acf4b/search-fuzzy-text.png 173w,\n/static/d6163360a94cad4d522a5a194188d280/fc834/search-fuzzy-text.png 345w,\n/static/d6163360a94cad4d522a5a194188d280/672f7/search-fuzzy-text.png 609w\"\n        sizes=\"(max-width: 609px) 100vw, 609px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Fuzzy Text Search</span>  </p>\n<br/>\n<p>이처럼 간단한 <code class=\"language-text\">Fuzzy Query</code>만으로 오타에 대한 자동완성을 대처할 수 있습니다  </p>\n<br/>\n<p><strong>Keyword Type Fuzzy Query</strong><br>\nKeyword Type은 Key가 전체의 문자으로 잡히기 때문에 Fuzzy Query로 긴 자동완성을 풀기엔 무리가 있습니다  </p>\n<p><span class='code_header'>Fuzzy Query Keyword Type Search</span>  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"fuzzy\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word.keyword\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스팀게임\"</span><span class=\"token punctuation\">,</span>  </span>        <span class=\"token property\">\"fuzziness\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 352px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.63636363636364%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAACaUlEQVQ4y4VTWVsiMRD0//+RfdgfsN++eKzKeiAocogiIgMydzKZJDPgUVszyCqH8lBf94ROpbq62cnDGE8/fuLm9z78/WOoowri/UPkZ1XYkzPifB7PL5DtHpS5fgOMyWGy2Rp2zMRH0uygn72h5SsMZAY5fUVop9CvvAiUUTOa1MJeXUO/bCGU1Tpk9ow7x8f1wMXAFUhkikkgkSiDjOSGvxs/gq03thC6PuJaA4ptDIIE9SFJxzF6noSXGMSpQdcbwjVUx0fs5YdCXT60qeWjvwgYUy+EogrhhiUM/bWhgHQ9pJFA9jhCVq3NrfhKoWZLKVt+OKigu1fB8Pgc939O4FSq0PUr+Kc19A9P0dytoPFrD26nB/v8Bv2u8DPmhExk/gJHGNRGEYbSwleW7WpYtpZMXyDyZ8T0MCKSQskGogJFXhIKqSGEQhgrFs9gLV/XWanCMLesyUlWwL5ftmU+h7b5ssK4MJ+KJJVNhEbHCdB06CO/k2IokwFaox7ao3vUBzdojfvo+xO0ixg8YRx6rLOrhAYJVTmRwiVXp+cJpPwWSpUXB4ELSXJlMqRUJHWRF9GWZ9pMNxCmGR65ey0qFCqDLwUcEol0/pjSRWuLltcn/N/DD0KLYahw+xShS0Q8C7h7w0Cx5RCNYYAu4+p016b8WaETJmhyuTtjTpyLXnjoeAEClSIkYiJ938GNi70gFAtwL2/HIdocSnGu6NEDjb9w2qg5HbQm96WH3xPK+YRDrk5h/Gpx6ZedLZ1vIltWSK8iYmH64tLq8m4jnS822wziZKnwO3yuWSO0+Yz/kGTN6K9a2oZ/vEFaU1lzXOgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"search-fuzzy-keyword\"\n        title=\"search-fuzzy-keyword\"\n        src=\"/static/48bba78d840c63e1345818ef5d2dea4c/0d1e4/search-fuzzy-keyword.png\"\n        srcset=\"/static/48bba78d840c63e1345818ef5d2dea4c/acf4b/search-fuzzy-keyword.png 173w,\n/static/48bba78d840c63e1345818ef5d2dea4c/fc834/search-fuzzy-keyword.png 345w,\n/static/48bba78d840c63e1345818ef5d2dea4c/0d1e4/search-fuzzy-keyword.png 352w\"\n        sizes=\"(max-width: 352px) 100vw, 352px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Fuzzy Keyword Search</span>  </p>\n<p>그래서 검색하면 다음과 같이 <code class=\"language-text\">스팀게임</code>만 결과로 나옵니다<br>\n<code class=\"language-text\">스팀게임 추천</code>과 <code class=\"language-text\">스팀게임</code>을 비교하면 빈공간과 추천이란 단어로 3개의 차이점이 보입니다<br>\n때문에 <code class=\"language-text\">fuzziness</code>의 1의 값과 맞지 않아 검색결과가 오로지 1건만 노출됩니다   </p>\n<br/>\n<hr>\n<br/>\n<h2 id=\"match-phrase-prefix\"><a href=\"#match-phrase-prefix\" aria-label=\"match phrase prefix permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Match Phrase Prefix</h2>\n<p>마지막으로 알아볼 것은 <code class=\"language-text\">Match Phrase Prefix</code>입니다<br>\nMatch Phrase Prefix는 많은 자동완성에서 실제로 많이 사용되고 있습니다<br>\n기본적으로 Text Type에 검색을 하며 앞색인어와 뒷색인어 둘 모두 만족해야만 검색이 되는 형식입니다<br>\n말로 하면 어려우니 실제 예제를 통해 살펴 보겠습니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"match_phrase_prefix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스팀게임 추\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 579px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 106.3903281519862%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAACP0lEQVQ4y5WU2XLTQBRE+f9/g4IigQp27Ei2ttFsmkWLnaTpkTDwQpg8dFmlKh913547H4ZW4vDxDt33Pfz+gHgoMBUVxocdolAIyzPiuCBOlyx9CASossa3UuDcSEihMYSIUJ4xnhuEy+v7gO5YQhF6qnociwa2U2hFB7V7RDy3BL4gjDNF6HhBmJbt+Z8OjUPx9QHF/Q797oBQnCD3JUfwCK8GTASO03VVgiXo2w75tW4YIeMC4Se4+Rl2XiDHEWIYoJyDpKyPeQ4HQowNEMbj81OHno6P3QlPXYVaS7TWrErgPGAgcIhoTcBJOvTWQqwfmOHCFReWMtF1ihxzIq8OCewJ+XRsURFaSYUfbY1SCrrT8HErZVWOQ2U9rCOU4CHMMMGjsYqzNatugFvTb5dCQM82HcHzcl1fpohJ6TlF9b/cZc9QM26K/KUQkHT51FfYtyWOosFZ9asEZ5vfMiGN9jh0LMRYVMoQEDm7m9vrn8hTZikdW74/9aiVQy0t3Sl+xMJyDW0YGXv+Dc2KrAl9bA0knQkWcZQVStXirHuOoIH2ftuW/wFTKVJvpTxfuWbzBfP8wvMHLMsr9bL+jvM1M3I6NtwS7UYWoWHchMZIuqqpdt2Wii57ruG7S0kzFGZAkUBKwfhtfmmOLk7vA6bVSy132qEl/CT9eoRSw7fVy46cClFDwF3ZExYYWWEveEFInkMtcBD1ejlklZKAkjdMKmV7uf3BcX/TUUlKcf3f6/eWQ8syDN3lnLGcyD8BA2FOD4LtsjcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"match-phrase-prefix1\"\n        title=\"match-phrase-prefix1\"\n        src=\"/static/6bf48a0387a2a1dacd9a3f857a64f1a8/d973d/match-phrase-prefix1.png\"\n        srcset=\"/static/6bf48a0387a2a1dacd9a3f857a64f1a8/acf4b/match-phrase-prefix1.png 173w,\n/static/6bf48a0387a2a1dacd9a3f857a64f1a8/fc834/match-phrase-prefix1.png 345w,\n/static/6bf48a0387a2a1dacd9a3f857a64f1a8/d973d/match-phrase-prefix1.png 579w\"\n        sizes=\"(max-width: 579px) 100vw, 579px\"\n        loading=\"lazy\"\n      />\n    </span>  </p>\n<p>보시는 것과 같이 이전 Prefix를 Keyword에 검색하는 것과 같은 결과가 나옵니다  </p>\n<br/>\n<p><strong>그럼 어떠한 경우에 다르게 나올까요?</strong>    </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"match_phrase_prefix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"추천 20\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 488px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.49180327868851%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAACP0lEQVQ4y41U2U7jQBDM///XSjwgpAUich/E94w9tx0CUm2NcxDYkPDQ6rE0XVPV1e2BsS0WD0Nkjy/QwxH8eIZ2tkSYzBA2GXy3Q2jf9hHPN2LgpIJ4eMLzPMV6laFOS6iyRqs92viAa0+g/hegA81iN11g035gVBq86hZ1eEO+DTCjEba++2T5K4bKovpzBzEco3oa9REoO38cIr27h1C+v+gPDP2J6WXGAxe2SHOJv9MEm7SCKCWcdqhKhUwYCNOi276jZcR8LPTtDwyN69DQmIa90pRa9z17h+06KO8hTQS1qK2DtBbahxOziww1wWI0JmCcSjxvBIwLmORrTPMVElliUwukjWCu+Li7LlmTkbL7mGQNUmlRKsptFLMnsy2lfpyi7d5/ZHcCjAxrMpyzb5OshtABRW2xEhqrSsOyz56MvoNdZRhBV6XGKJH87pBS3rRaYyETLGWGpcgwKzbsdSDw7szti4ABUpkvl2KOzOIUxLOL0Z93X8boAiBd5lbUnEd/uOjCYd66CLQlcHfI+wdu9lCxf1HyvGgwpMuxaF4mGGdLLJhXoqDDJdayYK/tDZfPxiYakkjD2dNIOCqSxcfC7+24akoPyJiS4TxvUCmHvHZ02GJR6L6w6zfl46rcL6ZEp5ccmxe6LLluiawwryhX5nhtONxNhTWlK//p8mXAg+Sa+6sILig90MlYWBqFivIb57iSDoVWvTFXTYm7HME0We5/ALvTEJ9vx/H7pmRzkLxv+v+/qUtxDfQfnNiwmk6YHoYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"match-phrase-prefix2\"\n        title=\"match-phrase-prefix2\"\n        src=\"/static/5fe74e129df9478e08dfd9a1a40b2f1b/2d6e0/match-phrase-prefix2.png\"\n        srcset=\"/static/5fe74e129df9478e08dfd9a1a40b2f1b/acf4b/match-phrase-prefix2.png 173w,\n/static/5fe74e129df9478e08dfd9a1a40b2f1b/fc834/match-phrase-prefix2.png 345w,\n/static/5fe74e129df9478e08dfd9a1a40b2f1b/2d6e0/match-phrase-prefix2.png 488w\"\n        sizes=\"(max-width: 488px) 100vw, 488px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Match Phrase Prefix</span>  </p>\n<p>이전과 다르게 2가지의 결과만 나왔습니다<br>\n<strong>추천과 20</strong>이라는 키워드를 차례대로 포함하고 있어서 입니다<br>\n일반적인 <span class='red_font'>like</span>검색과는 차이가 있습니다  </p>\n<br/>\n<p>색인키 <strong>스팀게임, 추천, 2019</strong>를 각각 가지고 있고 해당 색인키가 <code class=\"language-text\">차례대로 나올때에만</code> 검색이 됩니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"fuzzy\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"word\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"20 추천\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"fuzziness\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 230px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.173913043478265%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABxUlEQVQoz3VTXW/bMAzM//9ZA/ayrQmyrmvXrmmd2YplWZYsyd8ZbqQMZ2maPhA0IPJ4vKNX3TCh6UYUJuDbb4FtUiC3LUJokSsDITXafkJoeoR2iMH1S76M1TAeYVwLHzqUdYP1S45NInGzO0BUgYA6aOMg8hLj9JeaFtDh6oAIaAmwIjBHoIfK41Fo/CCmmfZIVA1lPCpT409Zw/gOHTM+Y3j+/R/Qhhj8+CoNbonl7b7AvahiofMNDckhCNQ1DHqM2X/IkMA4O9LqLlVY08o3tP53YrreCdztFTX1sLSJMBqfHr/iWWYEMr1Z/aQhg+mqjmvb0ENRY05GcS5oWB1mUxxlbpS2oroGbTe9X9lE/Xrs0wOK0kTxe3J/pLdhOMZvS4O4gR1nDZtm/r5qCjOsfUtMGnx+2Mc1E2XJ7QKblwO+POeRLV9CXihstz/x62mHNFcng8Ll2TCgIsANabd5ldGMlAyQlUNWaKoJkNrGZkWZT6mkWNidAHs2xc8a8tpPdDIPmUZSOrRsgiMNSw1tHQEadCQBr7rE5YGvWB9eJc1kLBiGadaNi093Nr7R6jzeMxzmKTUxXB79laZz4T/67Tj+AS/Hlmbp+YBwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"match-phrase-prefix3\"\n        title=\"match-phrase-prefix3\"\n        src=\"/static/a4a56520d8773bbf550987a52f168f5d/2b3f6/match-phrase-prefix3.png\"\n        srcset=\"/static/a4a56520d8773bbf550987a52f168f5d/acf4b/match-phrase-prefix3.png 173w,\n/static/a4a56520d8773bbf550987a52f168f5d/2b3f6/match-phrase-prefix3.png 230w\"\n        sizes=\"(max-width: 230px) 100vw, 230px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Match Phrase No Match</span><br>\n따라서 다음과 같이 색인키의 순서가 다를 때에는 검색에서는 결과가 나오지 않습니다  </p>\n<br/>\n<hr>\n<br/>\n<h2 id=\"combine-query\"><a href=\"#combine-query\" aria-label=\"combine query permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Combine Query</h2>\n<p>마지막은 위에서 언급한 것들을 적절하게 섞어서 쓰는 방식입니다<br>\nElastic에 bool 쿼리를 사용하여 쉽게 작성 가능합니다<br>\n예를 들어 아래 예제는 Fuzzy와 Prefix를 혼합하여 쓰는 방식입니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET autocomplete_test_<span class=\"token number\">1</span>/_search\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"bool\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"should\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"fuzzy\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"word.keyword\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스팀게임 불\"</span><span class=\"token punctuation\">,</span>\n              <span class=\"token property\">\"fuzziness\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"prefix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"word.keyword\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"스팀게임 \"</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 605px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.86776859504133%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAACAElEQVQ4y52UbW/TMBSF+/9/EwgEGkMgrRpoRe3WNGmSOonfnRcn7eBwna6FT5Dsw5EVyTk+18+9Xtja45EpZNxCmwatP6LzJzTdMCp8X9YpWtRtD05GP3KJtDJQroWq6+uGOWajYUgodI2DOsvUHZjS0LReUs5JOybcMomY0lXajUal7ih1C9+f0L1oatqFa84JueuQCgdLBzAjkWuOVAlKLVBohXDwxbT5Z8lkqG2LjAls0wqcc+wPKQQXMNbBNO2ouptq2A7QXKN88x7Juxuom084fLhF8fYj/GoDf/yFtpsO6JqwEAYPSQVBYJKKISozPBYJMsWvbTQJimt6MnFwTTdCGH/yw6hQZjB4FRRJ7cOIrKWfSmfBtCQYdBVGozJmJhRq7Cyv8BQziLJEnO1QKgnhHKSrR003pAs3cQb2dYnt5yXk/XeUX5boC4H+GfB0f+EOZ0DpoaVFmeRYrSKIPUMSbRCxBDvBUBj1Cih0h442+uNPtMMzmuGE+m8ofhaUM2VFIyecR+hLSY8DtzSK1tIEkWidBcW8TMp6d4DiYWIi5KIiwsHUQNDETDf0AUqKjEBsbu9Q3n8jKHcYiDpVj57IeNL0kunkMHpVlGL9sIWMc2RPa8SHGHtVIZMVPRByDhQPSX0YGroJUEimp/luO1ianvAw2Nb/Kfc/hr8BP+OySVJXNTUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"combine-1\"\n        title=\"combine-1\"\n        src=\"/static/ecc314c38e3b4921a0b7e08c3943750f/b1c25/combine-1.png\"\n        srcset=\"/static/ecc314c38e3b4921a0b7e08c3943750f/acf4b/combine-1.png 173w,\n/static/ecc314c38e3b4921a0b7e08c3943750f/fc834/combine-1.png 345w,\n/static/ecc314c38e3b4921a0b7e08c3943750f/b1c25/combine-1.png 605w\"\n        sizes=\"(max-width: 605px) 100vw, 605px\"\n        loading=\"lazy\"\n      />\n    </span>\n<span class='img_caption'>Fuzzy와 Prefix의 혼합</span>  </p>\n<br/>\n<p>결과를 보시면 Should를 사용하여 Fuzzy와 Prefix 중 한가지라도 조건이 맞으면 결과로 노출됩니다<br>\n여기서 확인해야 할것은 <code class=\"language-text\">score</code>에 의한 <code class=\"language-text\">정렬</code>입니다<br>\n맨처음 <strong>스팀게임 환불</strong>만 Fuzzy와 Prefix를 모두 만족시켜서 높은 스코어로 맨 위에 노출되었습니다  </p>\n<br/>\n \n실제로 Fuzzy쿼리만 검색해보시면 다음과 같은 score 확인이 가능합니다  \n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 389px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.14910025706942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACM0lEQVQ4y42UaXPaMBCG+f//KjOdHkxSEggJLuawwbdlS7LkA0jfrgwmxIFpPuzIlleP93hXA13t4MYcz26MICuQ5QVyoWD2jamyaa177vZv2cA4CVliFeWYOBF8JpFlAjlXLaCq9ihbaA1tVnPQgG/AB0rXSEUJ3hwwCXKMvAyLtIBHe4mqEGqKuibnA6DIp4OqmxHWezAvQrF0EM5XCKwltq82mO1AOxv41gR8vUaz8aFj9rUI828/4A5HyGc20qmF+NmCtGyI2Rze4wzuaAp//ApNflqVxwhPte3Xd1AQsHgYYX73E093v+AR2Pk+hJq8QI6nCO4fET6Mkf4eQw/vocm/D1SVifhYhrYpWVGB8QIRdblp9nSoOqfQUN1q2quoNOXurd0re2mqstflNJPgUiOnbrsJx9RNSEIKBTVlGW1hBQ7mZC/bFb17WMQelrGPTRoh5YJ+sD9F2gFJe5xgOUU681I8kXwYvaeCE2yFdRzQd9Kn0uBk3Sp0CVOys16vAe0gwyYR4IWmNUBMpWCnb5epmaguxf8x5RPQHLRDEjhNjZtKSIIs6AerWJLwBTJZYb8D6vpwtcufIuQE+OMzPK0jLAjMpaIoQyxTD3a8gZcnmIVrLJLte916evwAzGiGj40RxxR1g0jkBPBa83OGOYFdFrUj+R+gplWipDEzMumkYeTSNH9bqyjVHa11/XbzohgYQTICMoJ1TsWlaG9Y/yY6AyVpLWHi0wh95aq6Zv8AxvjFgiNxiIAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"combine-2\"\n        title=\"combine-2\"\n        src=\"/static/3b46308576045adf23bbda9d6aa05d69/48001/combine-2.png\"\n        srcset=\"/static/3b46308576045adf23bbda9d6aa05d69/acf4b/combine-2.png 173w,\n/static/3b46308576045adf23bbda9d6aa05d69/fc834/combine-2.png 345w,\n/static/3b46308576045adf23bbda9d6aa05d69/48001/combine-2.png 389w\"\n        sizes=\"(max-width: 389px) 100vw, 389px\"\n        loading=\"lazy\"\n      />\n    </span><br>\n이걸로 이전 결과가 <code class=\"language-text\">prefix 1 + fuzzy 1.4로 2.4</code>로 스코어 집계가 된걸 확인할 수 있습니다<br>\n이처럼 여러 조건을 혼합한 설계로 좋은 품질의 자동완성을 만드는 것이 가능합니다  </p>","frontmatter":{"title":"[Elastic] 1. Elastic 자동완성 가이드 (Autocomplete Guide) - Prefix Queries","date":"April 18, 2020"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/elastic/autocomplete/elastic-autocomplete-1/","previous":{"fields":{"slug":"/spring/batch/spring-batch-chapter-3/"},"frontmatter":{"title":"[Spring] 3. Spring Batch의 ItemReader - DB Item Reader","category":"Spring"}},"next":null}}}