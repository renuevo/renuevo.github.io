{"componentChunkName":"component---src-templates-blog-post-index-js","path":"/observer_pattern/","webpackCompilationHash":"0e029bac122412373e55","result":{"data":{"site":{"siteMetadata":{"title":"DRcode","author":"Deokhwa Kim"}},"markdownRemark":{"id":"0a86967f-7237-5b30-855b-01eee88fc20a","html":"<h2>옵저버 패턴 <span class=\"sub_header\">(Observer Pattern)</span></h2>\n<p>옵저버 패턴은 Java 내부와 Spring Core, Reative Programming의 기본이 되는 패턴입니다\n옵저버 디자인 패턴은 기본적으로 <code class=\"language-text\">Subject</code>와 <code class=\"language-text\">Observer</code>를 가지고 있습니다  </p>\n<blockquote>\n<p><strong>1. Subject</strong></p>\n<blockquote>\n<p>Observer의 Manager 개념으로 Observer를 등록하여 특정 이벤트가 발생했을때 관찰자들이 알 수 있도록 해준다  </p>\n</blockquote>\n</blockquote>\n<blockquote>\n<p><strong>2. Observer</strong></p>\n<blockquote>\n<p>실제 관찰자로 이벤트의 따른 기능들이 구현되어 있고, Subject에 등록되었다가 호출되어 진다  </p>\n</blockquote>\n</blockquote>\n<p>기본적으로 Observer 인터페이스를 생성해 두고 Observer를 구현해서 Subject의 등록해서 사용합니다<br>\n<strong><em>한마디로, 여러 기능들을 하나의 인터페이스로 통합해서 Subject의 등록해서 호출하는 로직으로 볼 수 있습니다 <span class=\"sub_header\">(1 대 N관계)</span></em></strong>  </p>\n<br/>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 854px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1b9096c3cb052b595e5153464847fe52/89d8e/Observer.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.33489461358314%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABRUlEQVQoz31SW8uCUBA8//+3RD1JaT7UW1CQlXZPpFAM09KudJuPWb4j0UMDy3LO2Z2dHVX4x/v9lnw+n7HdbpGmKYqiwOPxwP1+L8PzPCwWC4xGI1QqFbTbbURRJPd5nkNpwtfrJdn3fdRqNTQaDTiOg+PxKIUk55BOp4Nut4ter4d+v4/hcIjlcilBMUor05kErutKXC4XfGO1WgkJFU4mE6zXa1G42WykXn2SaTyfTyH+BGu4xel0KhXvdjvs93sh0vYovSoJuNLhcJBC+sjGJEmEhOAdLWFQEc+sz7JMCOlt6SEJqexb8e12E28IqgmCAOPxuCSmd3Ecy1D6qljASdPpVPwIw1AaqZLe8H02m0kTFVANm6lIB89cm32qWq3CMAyYpgnbtlGv1zGfzzEYDOS34NduNpuwLAutVgvX6xW/8AejFFVSVJp5ogAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"observer_pattern\"\n        title=\"observer_pattern\"\n        src=\"/static/1b9096c3cb052b595e5153464847fe52/89d8e/Observer.png\"\n        srcset=\"/static/1b9096c3cb052b595e5153464847fe52/07e12/Observer.png 240w,\n/static/1b9096c3cb052b595e5153464847fe52/5ca43/Observer.png 480w,\n/static/1b9096c3cb052b595e5153464847fe52/89d8e/Observer.png 854w\"\n        sizes=\"(max-width: 854px) 100vw, 854px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span class=\"img_caption\">출처 : <a href=\"https://ko.wikipedia.org/wiki/%EC%98%B5%EC%84%9C%EB%B2%84_%ED%8C%A8%ED%84%B4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">위키백과 옵서버 패턴</a></a></span></p>\n<hr>\n<p><strong><em>이해를 돕기위해 Observer 부터 구현해 보겠습니다</em></strong></p>\n<h3>Observer Sample</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Observer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>       <span class=\"token comment\">//옵저버 인터페이스</span>\n        <span class=\"token keyword\">void</span> <span class=\"token function\">printEvent</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span> event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ObserverEventA</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Observer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span> \n        <span class=\"token annotation punctuation\">@Override</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">printEvent</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> event<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Event : \"</span> <span class=\"token operator\">+</span> event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//옵저버 기능</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    </code></pre></div>\n<br/>\n<h3>Subject Sample</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Subject</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">void</span> <span class=\"token function\">registerObserver</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Observer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> observer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//옵저버 등록</span>\n\n        <span class=\"token keyword\">void</span> <span class=\"token function\">removeObserver</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Observer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> observer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//옵저버 삭제</span>\n\n        <span class=\"token keyword\">void</span> <span class=\"token function\">executeObserver</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span> event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>               <span class=\"token comment\">//옵저버 실행</span>\n    <span class=\"token punctuation\">}</span>\n\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SampleSubject</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Subject</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Set</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Observer</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> observerSet <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CopyOnWriteArraySet</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">//Thread Safe Set</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">registerObserver</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Observer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> observer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>observerSet<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">removeObserver</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Observer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> observer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>observerSet<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">executeObserver</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> event<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>observerSet<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>o <span class=\"token operator\">-></span> o<span class=\"token punctuation\">.</span><span class=\"token function\">printEvent</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<h3>Observer Run</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token annotation punctuation\">@Test</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">observerTest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\n        <span class=\"token class-name\">Subject</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> subject <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SampleSubject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      <span class=\"token comment\">//observer manager 생성</span>\n        \n        subject<span class=\"token punctuation\">.</span><span class=\"token function\">registerObserver</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ObserverEventA</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">//observer 등록</span>\n \n        subject<span class=\"token punctuation\">.</span><span class=\"token function\">registerObserver</span><span class=\"token punctuation\">(</span>event <span class=\"token operator\">-></span> <span class=\"token punctuation\">{</span>                 <span class=\"token comment\">//lambda식 등록도 가능합니다</span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Event : \"</span> <span class=\"token operator\">+</span> event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>         \n        \n        subject<span class=\"token punctuation\">.</span><span class=\"token function\">registerObserver</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token operator\">:</span><span class=\"token operator\">:</span><span class=\"token function\">println</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      <span class=\"token comment\">//lambda 단순 println</span>\n\n        subject<span class=\"token punctuation\">.</span><span class=\"token function\">executeObserver</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Observer Run\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>            <span class=\"token comment\">//실행</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<blockquote>\n<p><strong>실행 결과</strong></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Event : Observer Run\nEvent : Observer Run\nObserver Run</code></pre></div>\n<hr>\n<h2>마무리</h2>\n<p>Java에서도 JDK1.0에서 Observer와 Observable이 릴리즈되어 사용할 수 있습니다<br>\n하지만 자바 제네릭이 없던 시절이라.. Object타입을 사용해서 안전성이 보장되지 않습니다\n그래서 인지 <strong>JDK9 버젼</strong> 부터는 <strong>Deprecated</strong> 되었습니다</p>\n<br/>\n<p>더 나아가 Observer 구현해서 사용 하시기전 다음과 같은 사항을 권고하고 있습니다  </p>\n<blockquote>\n<p><strong>1. 이벤트 모델</strong></p>\n<blockquote>\n<p>Java.beans 패키지 사용으로 구성  </p>\n</blockquote>\n</blockquote>\n<blockquote>\n<p><strong>2. 쓰레드간 메시징</strong></p>\n<blockquote>\n<p>java.util.concurrent 패키지에서 동시 데이터 조작 구조를 사용  </p>\n</blockquote>\n</blockquote>\n<blockquote>\n<p><strong>3. Reactive Programing</strong></p>\n<blockquote>\n<p>Flow API를 참조하여 구현</p>\n</blockquote>\n</blockquote>\n<p>자세한 관련 내용은 <a href=\"https://dzone.com/articles/javas-observer-and-observable-are-deprecated-in-jd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Java's Observer and Observable Are Deprecated in JDK 9</a>를 참고 하세요</p>","excerpt":"옵저버 패턴 (Observer Pattern)옵저버 패턴은 Java 내부와 Spring Core, Reative Programming의 기본이 되는 패턴입니다\n옵저버 디자인 패턴은 기본적으로 와 를 가지고 있습니다  1. SubjectObserver…","frontmatter":{"title":"Observer Pattern","date":"2019-09-05","tags":["DesignPattern"],"keywords":["Observer","Observer Pattern","design pattern","디자인 패턴","옵저버","옵저버 패턴"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/observer_pattern/","previous":{"fields":{"slug":"/spring_aop/"},"frontmatter":{"title":"Spring AOP","tags":["Spring","SpringBoot","AOP","Aspect"],"published":true}},"next":{"fields":{"slug":"/blocking_nonBlocking_synchronous_asynchronous/"},"frontmatter":{"title":"동기(Synchronous)와 비동기(Asynchronous) & 블로킹(Blocking)과 논블로킹(NonBlocking)","tags":["Spring","SpringBoot","Notion"],"published":true}}}}}